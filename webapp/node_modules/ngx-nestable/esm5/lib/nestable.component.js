/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, NgZone, Output, Renderer2, ViewContainerRef, ViewEncapsulation } from '@angular/core';
import * as helper from './nestable.helper';
import { defaultSettings, DRAG_START, EXPAND_COLLAPSE, mouse, REGISTER_HANDLE } from './nestable.constant';
/** @type {?} */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';

function NestableComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function NestableComponent_ng_template_1_li_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function NestableComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
var _c0 = function (a0, a1) { return { nestable: a0, depth: a1 }; };
function NestableComponent_ng_template_1_li_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    var item_r8 = ɵngcc0.ɵɵnextContext().$implicit;
    var depth_r6 = ɵngcc0.ɵɵnextContext().depth;
    ɵngcc0.ɵɵnextContext();
    var _r1 = ɵngcc0.ɵɵreference(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r1)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c0, item_r8.children, depth_r6 + 1));
} }
var _c1 = function (a0, a1, a2) { return { nestable: a0, item: a1, depth: a2 }; };
function NestableComponent_ng_template_1_li_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "li", 4);
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵtemplate(2, NestableComponent_ng_template_1_li_1_ng_container_2_Template, 2, 5, "ng-container", 5);
    ɵngcc0.ɵɵelement(3, "ul");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var item_r8 = ctx.$implicit;
    var ctx_r14 = ɵngcc0.ɵɵnextContext();
    var nestable_r5 = ctx_r14.nestable;
    var depth_r6 = ctx_r14.depth;
    var ctx_r7 = ɵngcc0.ɵɵnextContext();
    var _r3 = ɵngcc0.ɵɵreference(4);
    ɵngcc0.ɵɵclassMap(ctx_r7.options.itemClass);
    ɵngcc0.ɵɵproperty("id", item_r8.$$id);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r3)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction3(10, _c1, nestable_r5, item_r8, depth_r6));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", item_r8.children && item_r8.$$expanded);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵclassMap(ctx_r7.options.listClass);
    ɵngcc0.ɵɵstyleProp("padding-left", ctx_r7.options.threshold, "px");
} }
function NestableComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "ul");
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_Template, 4, 14, "li", 3);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var nestable_r5 = ctx.nestable;
    var depth_r6 = ctx.depth;
    var ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassMap(ctx_r2.options.listClass);
    ɵngcc0.ɵɵstyleProp("padding-left", depth_r6 ? ctx_r2.options.threshold : 0, "px");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", nestable_r5);
} }
function NestableComponent_ng_template_3_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
var _c2 = function (a0, a1) { return { item: a0, parentList: a1 }; };
var _c3 = function (a0, a1) { return { $implicit: a0, depth: a1 }; };
function NestableComponent_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    var _r20 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 6);
    ɵngcc0.ɵɵlistener("mousedown", function NestableComponent_ng_template_3_Template_div_mousedown_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r20); var item_r16 = ctx.item; var parentList_r15 = ctx.nestable; var ctx_r19 = ɵngcc0.ɵɵnextContext(); return ctx_r19.dragStartFromItem($event, item_r16, parentList_r15); });
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_3_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelement(2, "div", 7);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var parentList_r15 = ctx.nestable;
    var item_r16 = ctx.item;
    var depth_r17 = ctx.depth;
    var ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r4.template)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(5, _c3, ɵngcc0.ɵɵpureFunction2(2, _c2, item_r16, parentList_r15), depth_r17));
} }
var _c4 = function (a0) { return { nestable: a0, depth: 0 }; };
var PX = 'px';
var ɵ0 = /**
 * @return {?}
 */
function () {
    /** @type {?} */
    var el = document.createElement('div');
    /** @type {?} */
    var docEl = document.documentElement;
    if (!('pointerEvents' in el.style)) {
        return false;
    }
    el.style.pointerEvents = 'auto';
    el.style.pointerEvents = 'x';
    docEl.appendChild(el);
    /** @type {?} */
    var supports = window.getComputedStyle &&
        window.getComputedStyle(el, '').pointerEvents === 'auto';
    docEl.removeChild(el);
    return !!supports;
};
/** @type {?} */
var hasPointerEvents = ((ɵ0))();
var NestableComponent = /** @class */ (function () {
    function NestableComponent(ref, renderer, el, zone) {
        this.ref = ref;
        this.renderer = renderer;
        this.el = el;
        this.zone = zone;
        this.listChange = new EventEmitter();
        this.drop = new EventEmitter();
        this.drag = new EventEmitter();
        this.disclosure = new EventEmitter();
        this.options = defaultSettings;
        this.disableDrag = false;
        this.dragRootEl = null;
        this.dragEl = null;
        this.dragModel = null;
        this.moving = false;
        /**
         * Dragged element contains children, and those children contain other children and so on...
         * This property gives you the number of generations contained within the dragging item.
         */
        this.dragDepth = 0;
        /**
         * The depth of dragging item relative to element root (ngx-nestable)
         */
        this.relativeDepth = 0;
        this.hasNewRoot = false;
        this.pointEl = null;
        this.items = [];
        this._componentActive = false;
        this._mouse = Object.assign({}, mouse);
        this._list = [];
        this._itemId = 0;
        this._registerHandleDirective = false;
    }
    Object.defineProperty(NestableComponent.prototype, "list", {
        get: /**
         * @return {?}
         */
        function () {
            return this._list;
        },
        set: /**
         * @param {?} list
         * @return {?}
         */
        function (list) {
            this._list = list;
            this._generateItemIds();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NestableComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var e_1, _a;
        // set/extend default options
        this._componentActive = true;
        /** @type {?} */
        var optionKeys = Object.keys(defaultSettings);
        try {
            for (var optionKeys_1 = tslib_1.__values(optionKeys), optionKeys_1_1 = optionKeys_1.next(); !optionKeys_1_1.done; optionKeys_1_1 = optionKeys_1.next()) {
                var key = optionKeys_1_1.value;
                if (typeof this.options[key] === 'undefined') {
                    this.options[key] = defaultSettings[key];
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (optionKeys_1_1 && !optionKeys_1_1.done && (_a = optionKeys_1.return)) _a.call(optionKeys_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this._generateItemIds();
        this._generateItemExpanded();
        this._createHandleListener();
    };
    /**
     * @return {?}
     */
    NestableComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () { };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._generateItemIds = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item['$$id'] = _this._itemId++;
        }));
    };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._generateItemExpanded = /**
     * @private
     * @return {?}
     */
    function () {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (typeof item.expanded === 'undefined') {
                item['$$expanded'] = true;
            }
            else {
                item['$$expanded'] = item.expanded;
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._createHandleListener = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.renderer.listen(this.el.nativeElement, REGISTER_HANDLE, (/**
         * @return {?}
         */
        function () {
            _this._registerHandleDirective = true;
        }));
        this.renderer.listen(this.el.nativeElement, DRAG_START, (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.dragStart(data.detail.event, data.detail.param.item, data.detail.param.parentList);
        }));
        this.renderer.listen(this.el.nativeElement, EXPAND_COLLAPSE, (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.disclosure.emit({
                item: data.detail.item,
                expanded: data.detail.item['$$expanded']
            });
        }));
    };
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    NestableComponent.prototype._createDragClone = /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    function (event, dragItem) {
        this._mouseStart(event, dragItem);
        if (!this._registerHandleDirective) {
            this._mouse.offsetY = dragItem.nextElementSibling
                ? dragItem.nextElementSibling.clientHeight / 2
                : dragItem.clientHeight / 2;
        }
        // create drag clone
        this.dragEl = document.createElement(this.options.listNodeName);
        document.body.appendChild(this.dragEl);
        this.renderer.addClass(this.dragEl, this.options.dragClass);
        // add drag clone to body and set css
        this.renderer.setStyle(this.dragEl, 'left', event.pageX - this._mouse.offsetX + PX);
        this.renderer.setStyle(this.dragEl, 'top', event.pageY - this._mouse.offsetY + PX);
        this.renderer.setStyle(this.dragEl, 'position', 'absolute');
        this.renderer.setStyle(this.dragEl, 'z-index', 9999);
        this.renderer.setStyle(this.dragEl, 'pointer-events', 'none');
    };
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    NestableComponent.prototype._createPlaceholder = /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    function (event, dragItem) {
        this._placeholder = document.createElement('div');
        this._placeholder.classList.add(this.options.placeClass);
        helper._insertAfter(this._placeholder, dragItem);
        dragItem.parentNode.removeChild(dragItem);
        this.dragEl.appendChild(dragItem);
        this.dragRootEl = dragItem;
    };
    /**
     * Sets depth proerties (relative and drag)
     */
    /**
     * Sets depth proerties (relative and drag)
     * @private
     * @return {?}
     */
    NestableComponent.prototype._calculateDepth = /**
     * Sets depth proerties (relative and drag)
     * @private
     * @return {?}
     */
    function () {
        // total depth of dragging item
        /** @type {?} */
        var depth;
        /** @type {?} */
        var items = this.dragEl.querySelectorAll(this.options.itemNodeName);
        for (var i = 0; i < items.length; i++) {
            depth = helper._getParents(items[i], this.dragEl).length;
            if (depth > this.dragDepth) {
                this.dragDepth = depth;
            }
        }
        // depth relative to root
        this.relativeDepth = helper._getParents(this._placeholder, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
    };
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    NestableComponent.prototype._mouseStart = /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    function (event, dragItem) {
        this._mouse.offsetX = event.pageX - helper._offset(dragItem).left;
        this._mouse.offsetY = event.pageY - helper._offset(dragItem).top;
        this._mouse.startX = this._mouse.lastX = event.pageX;
        this._mouse.startY = this._mouse.lastY = event.pageY;
    };
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    NestableComponent.prototype._mouseUpdate = /**
     * @private
     * @param {?} event
     * @return {?}
     */
    function (event) {
        // mouse position last events
        this._mouse.lastX = this._mouse.nowX;
        this._mouse.lastY = this._mouse.nowY;
        // mouse position this events
        this._mouse.nowX = event.pageX;
        this._mouse.nowY = event.pageY;
        // distance mouse moved between events
        this._mouse.distX = this._mouse.nowX - this._mouse.lastX;
        this._mouse.distY = this._mouse.nowY - this._mouse.lastY;
        // direction mouse was moving
        this._mouse.lastDirX = this._mouse.dirX;
        this._mouse.lastDirY = this._mouse.dirY;
        // direction mouse is now moving (on both axis)
        this._mouse.dirX =
            this._mouse.distX === 0 ? 0 : this._mouse.distX > 0 ? 1 : -1;
        this._mouse.dirY =
            this._mouse.distY === 0 ? 0 : this._mouse.distY > 0 ? 1 : -1;
    };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._showMasks = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var masks = this.el.nativeElement.getElementsByClassName('nestable-item-mask');
        for (var i = 0; i < masks.length; i++) {
            masks[i].style.display = 'block';
        }
    };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._hideMasks = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var masks = this.el.nativeElement.getElementsByClassName('nestable-item-mask');
        for (var i = 0; i < masks.length; i++) {
            masks[i].style.display = 'none';
        }
    };
    /**
     * calc mouse traverse distance on axis
     * @param m - mouse
     */
    /**
     * calc mouse traverse distance on axis
     * @private
     * @param {?} m - mouse
     * @return {?}
     */
    NestableComponent.prototype._calcMouseDistance = /**
     * calc mouse traverse distance on axis
     * @private
     * @param {?} m - mouse
     * @return {?}
     */
    function (m) {
        m.distAxX += Math.abs(m.distX);
        if (m.dirX !== 0 && m.dirX !== m.lastDirX) {
            m.distAxX = 0;
        }
        m.distAxY += Math.abs(m.distY);
        if (m.dirY !== 0 && m.dirY !== m.lastDirY) {
            m.distAxY = 0;
        }
    };
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    NestableComponent.prototype._move = /**
     * @private
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var depth;
        /** @type {?} */
        var list;
        /** @type {?} */
        var dragRect = this.dragEl.getBoundingClientRect();
        this.renderer.setStyle(this.dragEl, 'left', event.pageX - this._mouse.offsetX + PX);
        this.renderer.setStyle(this.dragEl, 'top', event.pageY - this._mouse.offsetY + PX);
        this._mouseUpdate(event);
        // axis mouse is now moving on
        /** @type {?} */
        var newAx = Math.abs(this._mouse.distX) > Math.abs(this._mouse.distY) ? 1 : 0;
        // do nothing on first move
        if (!this._mouse.moving) {
            this._mouse.dirAx = newAx;
            this._mouse.moving = 1;
            return;
        }
        // calc distance moved on this axis (and direction)
        if (this._mouse.dirAx !== newAx) {
            this._mouse.distAxX = 0;
            this._mouse.distAxY = 0;
        }
        else {
            this._calcMouseDistance(this._mouse);
        }
        this._mouse.dirAx = newAx;
        // find list item under cursor
        if (!hasPointerEvents) {
            this.dragEl.style.visibility = 'hidden';
        }
        /** @type {?} */
        var pointEl = document.elementFromPoint(event.pageX - document.body.scrollLeft, event.pageY - (window.pageYOffset || document.documentElement.scrollTop));
        if (!hasPointerEvents) {
            this.dragEl.style.visibility = 'visible';
        }
        if (pointEl &&
            (pointEl.classList.contains('nestable-item-mask') ||
                pointEl.classList.contains(this.options.placeClass))) {
            this.pointEl = pointEl.parentElement.parentElement;
        }
        else {
            return;
        }
        /**
         * move horizontal
         */
        if (!this.options.fixedDepth &&
            this._mouse.dirAx &&
            this._mouse.distAxX >= this.options.threshold) {
            // reset move distance on x-axis for new phase
            this._mouse.distAxX = 0;
            /** @type {?} */
            var previous = this._placeholder.previousElementSibling;
            // increase horizontal level if previous sibling exists, is not collapsed, and can have children
            if (this._mouse.distX > 0 && previous) {
                list = previous.querySelectorAll(this.options.listNodeName);
                list = list[list.length - 1];
                // check if depth limit has reached
                depth = helper._getParents(this._placeholder, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
                if (depth + this.dragDepth <= this.options.maxDepth) {
                    // create new sub-level if one doesn't exist
                    if (!list) {
                        list = document.createElement(this.options.listNodeName);
                        list.style.paddingLeft = this.options.threshold + PX;
                        list.appendChild(this._placeholder);
                        previous.appendChild(list);
                        // this.setParent(previous);
                    }
                    else {
                        // else append to next level up
                        list = previous.querySelector(":scope > " + this.options.listNodeName);
                        list.appendChild(this._placeholder);
                    }
                }
            }
            // decrease horizontal level
            if (this._mouse.distX < 0) {
                // we can't decrease a level if an item preceeds the current one
                /** @type {?} */
                var next = document.querySelector("." + this.options.placeClass + " + " + this.options.itemNodeName);
                /** @type {?} */
                var parentElement = this._placeholder.parentElement;
                if (!next && parentElement) {
                    /** @type {?} */
                    var closestItem = helper._closest(this._placeholder, this.options.itemNodeName);
                    if (closestItem) {
                        parentElement.removeChild(this._placeholder);
                        helper._insertAfter(this._placeholder, closestItem);
                    }
                }
            }
        }
        if (!pointEl.classList.contains('nestable-item-mask')) {
            return;
        }
        // find root list of item under cursor
        /** @type {?} */
        var pointElRoot = helper._closest(this.pointEl, "." + this.options.rootClass);
        /** @type {?} */
        var isNewRoot = pointElRoot
            ? this.dragRootEl.dataset['nestable-id'] !==
                pointElRoot.dataset['nestable-id']
            : false;
        /**
         * move vertical
         */
        if (!this._mouse.dirAx || isNewRoot) {
            // check if groups match if dragging over new root
            if (isNewRoot &&
                this.options.group !== pointElRoot.dataset['nestable-group']) {
                return;
            }
            // check depth limit
            depth =
                this.dragDepth -
                    1 +
                    helper._getParents(this.pointEl, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
            if (depth > this.options.maxDepth) {
                return;
            }
            /** @type {?} */
            var before = event.pageY <
                helper._offset(this.pointEl).top + this.pointEl.clientHeight / 2;
            /** @type {?} */
            var placeholderParent = this._placeholder.parentNode;
            // get point element depth
            /** @type {?} */
            var pointRelativeDepth = void 0;
            pointRelativeDepth = helper._getParents(this.pointEl, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
            if (this.options.fixedDepth) {
                if (pointRelativeDepth === this.relativeDepth - 1) {
                    /** @type {?} */
                    var childList = this.pointEl.querySelector(this.options.listNodeName);
                    if (!childList.children.length) {
                        childList.appendChild(this._placeholder);
                    }
                }
                else if (pointRelativeDepth === this.relativeDepth) {
                    if (before) {
                        this.pointEl.parentElement.insertBefore(this._placeholder, this.pointEl);
                    }
                    else {
                        helper._insertAfter(this._placeholder, this.pointEl);
                    }
                    if (Array.prototype.indexOf.call(this.pointEl.parentElement.children, this.pointEl) ===
                        this.pointEl.parentElement.children.length - 1) {
                        helper._insertAfter(this._placeholder, this.pointEl);
                    }
                }
            }
            else if (before) {
                this.pointEl.parentElement.insertBefore(this._placeholder, this.pointEl);
            }
            else {
                helper._insertAfter(this._placeholder, this.pointEl);
            }
        }
    };
    /**
     * @return {?}
     */
    NestableComponent.prototype.reset = /**
     * @return {?}
     */
    function () {
        var e_2, _a;
        /** @type {?} */
        var keys = Object.keys(this._mouse);
        try {
            for (var keys_1 = tslib_1.__values(keys), keys_1_1 = keys_1.next(); !keys_1_1.done; keys_1_1 = keys_1.next()) {
                var key = keys_1_1.value;
                this._mouse[key] = 0;
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (keys_1_1 && !keys_1_1.done && (_a = keys_1.return)) _a.call(keys_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        this._itemId = 0;
        this.moving = false;
        this.dragEl = null;
        this.dragRootEl = null;
        this.dragDepth = 0;
        this.relativeDepth = 0;
        this.hasNewRoot = false;
        this.pointEl = null;
    };
    /**
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    NestableComponent.prototype.dragStartFromItem = /**
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    function (event, item, parentList) {
        if (!this._registerHandleDirective) {
            this.dragStart(event, item, parentList);
        }
    };
    /**
     * @private
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    NestableComponent.prototype.dragStart = /**
     * @private
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    function (event, item, parentList) {
        this._oldListLength = this.list.length;
        if (!this.options.disableDrag) {
            event.stopPropagation();
            event.preventDefault();
            if (event.originalEvent) {
                event = event.originalEvent;
            }
            // allow only first mouse button
            if (event.type.indexOf('mouse') === 0) {
                if (event.button !== 0) {
                    return;
                }
            }
            else {
                if (event.touches.length !== 1) {
                    return;
                }
            }
            this.ref.detach();
            this._dragIndex = parentList.indexOf(item);
            this.dragModel = parentList.splice(parentList.indexOf(item), 1)[0];
            /** @type {?} */
            var dragItem = helper._closest(event.target, this.options.itemNodeName);
            if (dragItem === null) {
                return;
            }
            this._parentDragId = Number.parseInt(dragItem.parentElement.parentElement.id);
            /** @type {?} */
            var dragRect = dragItem.getBoundingClientRect();
            this._showMasks();
            this._createDragClone(event, dragItem);
            this.renderer.setStyle(this.dragEl, 'width', dragRect.width + PX);
            this._createPlaceholder(event, dragItem);
            this.renderer.setStyle(this._placeholder, 'height', dragRect.height + PX);
            this._calculateDepth();
            this.drag.emit({
                originalEvent: event,
                item: item
            });
            this._cancelMouseup = this.renderer.listen(document, 'mouseup', this.dragStop.bind(this));
            this._cancelMousemove = this.renderer.listen(document, 'mousemove', this.dragMove.bind(this));
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    NestableComponent.prototype.dragStop = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this._cancelMouseup();
        this._cancelMousemove();
        this._hideMasks();
        if (this.dragEl) {
            /** @type {?} */
            var draggedId = Number.parseInt(this.dragEl.firstElementChild.id);
            /** @type {?} */
            var placeholderContainer = helper._closest(this._placeholder, this.options.itemNodeName);
            /** @type {?} */
            var changedElementPosition = this._dragIndex !==
                Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder);
            /** @type {?} */
            var index = Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder);
            if ((this._dragIndex === index) && (this._oldListLength === this.list.length)) {
                changedElementPosition = true;
            }
            // placeholder in root
            if (placeholderContainer === null) {
                this.list.splice(Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder), 0, tslib_1.__assign({}, this.dragModel));
            }
            else {
                // palceholder nested
                placeholderContainer = helper._findObjectInTree(this.list, Number.parseInt(placeholderContainer.id));
                if (!placeholderContainer.children) {
                    placeholderContainer.children = [];
                    placeholderContainer.children.push(tslib_1.__assign({}, this.dragModel));
                }
                else {
                    placeholderContainer.children.splice(Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder), 0, tslib_1.__assign({}, this.dragModel));
                }
                if (index === this._dragIndex) {
                    changedElementPosition = false;
                }
                if (!changedElementPosition) {
                    changedElementPosition =
                        placeholderContainer['$$id'] !== this._parentDragId;
                }
            }
            this._placeholder.parentElement.removeChild(this._placeholder);
            this.dragEl.parentNode.removeChild(this.dragEl);
            this.dragEl.remove();
            this.reset();
            this.listChange.emit(this.list);
            this.drop.emit({
                originalEvent: event,
                destination: placeholderContainer,
                item: this.dragModel,
                changedElementPosition: changedElementPosition
            });
            this.ref.reattach();
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    NestableComponent.prototype.dragMove = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.dragEl) {
            event.preventDefault();
            if (event.originalEvent) {
                event = event.originalEvent;
            }
            this._move(event.type.indexOf('mouse') === 0 ? event : event.touches[0]);
        }
    };
    /**
     * @return {?}
     */
    NestableComponent.prototype.expandAll = /**
     * @return {?}
     */
    function () {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item['$$expanded'] = true;
        }));
        this.ref.markForCheck();
    };
    /**
     * @return {?}
     */
    NestableComponent.prototype.collapseAll = /**
     * @return {?}
     */
    function () {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item['$$expanded'] = false;
        }));
        this.ref.markForCheck();
    };
    /** @nocollapse */
    NestableComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef },
        { type: Renderer2 },
        { type: ElementRef },
        { type: NgZone }
    ]; };
    NestableComponent.propDecorators = {
        listChange: [{ type: Output }],
        drop: [{ type: Output }],
        drag: [{ type: Output }],
        disclosure: [{ type: Output }],
        template: [{ type: Input }],
        options: [{ type: Input }],
        disableDrag: [{ type: Input }],
        list: [{ type: Input }]
    };
NestableComponent.ɵfac = function NestableComponent_Factory(t) { return new (t || NestableComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };
NestableComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: NestableComponent, selectors: [["ngx-nestable"]], inputs: { options: "options", disableDrag: "disableDrag", list: "list", template: "template" }, outputs: { listChange: "listChange", drop: "drop", drag: "drag", disclosure: "disclosure" }, decls: 5, vars: 4, consts: [[4, "ngTemplateOutlet", "ngTemplateOutletContext"], ["nestableList", ""], ["nestableItem", ""], [3, "class", "id", 4, "ngFor", "ngForOf"], [3, "id"], [4, "ngIf"], [1, "nestable-item-container", "mat-list-item", 3, "mousedown"], [1, "nestable-item-mask"]], template: function NestableComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, NestableComponent_ng_container_0_Template, 1, 0, "ng-container", 0);
        ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_Template, 2, 5, "ng-template", null, 1, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(3, NestableComponent_ng_template_3_Template, 3, 8, "ng-template", null, 2, ɵngcc0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        var _r1 = ɵngcc0.ɵɵreference(2);
        ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r1)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c4, ctx.list));
    } }, directives: [ɵngcc1.NgTemplateOutlet, ɵngcc1.NgForOf, ɵngcc1.NgIf], styles: ["@import url(https://fonts.googleapis.com/css?family=Roboto);ul .dd-placeholder{margin:5px 0;padding:0;min-height:30px;background:#f2fbff;border:1px dashed #b6bcbf;box-sizing:border-box}ul li .nestable-item-mask{display:none;position:absolute;top:0;bottom:0;right:0;left:0;z-index:9998}ul li .nestable-expand-button{display:block;position:relative;cursor:pointer;float:left;width:25px;height:14px;padding:0;white-space:nowrap;overflow:hidden;border:0;background:0 0;font-size:18px;line-height:1;text-align:center;font-weight:700;outline:0}ul li .nestable-item-container{position:relative;display:flex;flex-direction:row;align-items:center;color:rgba(0,0,0,.87);min-height:32px;font-size:16px;font-family:Roboto,sans-serif;cursor:pointer;outline:0;margin-bottom:2px;padding-left:8px}ul li .nestable-item-container:hover{background:rgba(0,0,0,.04)}ol,ul{list-style:none}"], encapsulation: 2, changeDetection: 0 });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(NestableComponent, [{
        type: Component,
        args: [{
                selector: 'ngx-nestable',
                template: "<ng-container *ngTemplateOutlet=\"nestableList; context:{nestable: list, depth: 0}\">\n</ng-container>\n\n<ng-template #nestableList let-nestable=\"nestable\" let-depth=\"depth\">\n    <ul [style.padding-left.px]=\"depth ? options.threshold : 0\"\n        [class]=\"options.listClass\">\n        <li [class]=\"options.itemClass\" [id]=\"item.$$id\" *ngFor=\"let item of nestable\">\n\n            <ng-container *ngTemplateOutlet=\"nestableItem; context:{nestable: nestable, item: item, depth: depth}\">\n            </ng-container>\n\n            <ng-container *ngIf=\"item.children && item.$$expanded\">\n                <ng-container *ngTemplateOutlet=\"nestableList; context:{nestable: item.children, depth: depth + 1}\">\n                </ng-container>\n            </ng-container>\n\n            <ul [class]=\"options.listClass\" [style.padding-left.px]=\"options.threshold\"></ul>\n        </li>\n    </ul>\n</ng-template>\n\n<ng-template #nestableItem let-parentList=\"nestable\" let-item=\"item\" let-depth=\"depth\">\n    <div class=\"nestable-item-container mat-list-item\" (mousedown)=\"dragStartFromItem($event, item, parentList)\">\n        <ng-container\n            *ngTemplateOutlet=\"template; context:{$implicit: {item: item, parentList: parentList}, depth: depth}\">\n        </ng-container>\n\n        <div class=\"nestable-item-mask\"></div>\n    </div>\n</ng-template>\n",
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: ["@import url(https://fonts.googleapis.com/css?family=Roboto);ul .dd-placeholder{margin:5px 0;padding:0;min-height:30px;background:#f2fbff;border:1px dashed #b6bcbf;box-sizing:border-box}ul li .nestable-item-mask{display:none;position:absolute;top:0;bottom:0;right:0;left:0;z-index:9998}ul li .nestable-expand-button{display:block;position:relative;cursor:pointer;float:left;width:25px;height:14px;padding:0;white-space:nowrap;overflow:hidden;border:0;background:0 0;font-size:18px;line-height:1;text-align:center;font-weight:700;outline:0}ul li .nestable-item-container{position:relative;display:flex;flex-direction:row;align-items:center;color:rgba(0,0,0,.87);min-height:32px;font-size:16px;font-family:Roboto,sans-serif;cursor:pointer;outline:0;margin-bottom:2px;padding-left:8px}ul li .nestable-item-container:hover{background:rgba(0,0,0,.04)}ol,ul{list-style:none}"]
            }]
    }], function () { return [{ type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.NgZone }]; }, { listChange: [{
            type: Output
        }], drop: [{
            type: Output
        }], drag: [{
            type: Output
        }], disclosure: [{
            type: Output
        }], options: [{
            type: Input
        }], disableDrag: [{
            type: Input
        }], list: [{
            type: Input
        }], template: [{
            type: Input
        }] }); })();
    return NestableComponent;
}());
export { NestableComponent };
if (false) {
    /** @type {?} */
    NestableComponent.prototype.listChange;
    /** @type {?} */
    NestableComponent.prototype.drop;
    /** @type {?} */
    NestableComponent.prototype.drag;
    /** @type {?} */
    NestableComponent.prototype.disclosure;
    /** @type {?} */
    NestableComponent.prototype.template;
    /** @type {?} */
    NestableComponent.prototype.options;
    /** @type {?} */
    NestableComponent.prototype.disableDrag;
    /** @type {?} */
    NestableComponent.prototype.dragRootEl;
    /** @type {?} */
    NestableComponent.prototype.dragEl;
    /** @type {?} */
    NestableComponent.prototype.dragModel;
    /** @type {?} */
    NestableComponent.prototype.moving;
    /**
     * Dragged element contains children, and those children contain other children and so on...
     * This property gives you the number of generations contained within the dragging item.
     * @type {?}
     */
    NestableComponent.prototype.dragDepth;
    /**
     * The depth of dragging item relative to element root (ngx-nestable)
     * @type {?}
     */
    NestableComponent.prototype.relativeDepth;
    /** @type {?} */
    NestableComponent.prototype.hasNewRoot;
    /** @type {?} */
    NestableComponent.prototype.pointEl;
    /** @type {?} */
    NestableComponent.prototype.items;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._componentActive;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._mouse;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._list;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._cancelMousemove;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._cancelMouseup;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._placeholder;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._itemId;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._registerHandleDirective;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._dragIndex;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._parentDragId;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._oldListLength;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.ref;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.zone;
}
export { ɵ0 };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmVzdGFibGUuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyJuZzovbmd4LW5lc3RhYmxlL2xpYi9uZXN0YWJsZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0gsdUJBQXVCLEVBQ3ZCLGlCQUFpQixFQUNqQixTQUFTLEVBQ1QsVUFBVSxFQUNWLFlBQVksRUFDWixLQUFLLEVBQ0wsTUFBTSxFQUdOLE1BQU0sRUFDTixTQUFTLEVBQ1QsZ0JBQWdCLEVBQ2hCLGlCQUFpQixFQUNwQixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEtBQUssTUFBTSxNQUFNLG1CQUFtQixDQUFDO0FBRTVDLE9BQU8sRUFBRSxlQUFlLEVBQUUsVUFBVSxFQUFFLGVBQWUsRUFBRSxLQUFLLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDM0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNnQixJQUFWLEVBQUUsR0FBRyxJQUFJO0FBQ2Y7QUFBYTtBQUFlO0FBQUY7QUFDMUI7QUFBcUIsUUFBWCxFQUFFLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUM7QUFDNUM7QUFBcUIsUUFBYixLQUFLLEdBQUcsUUFBUSxDQUFDLGVBQWU7QUFDeEMsSUFDSSxJQUFJLENBQUMsQ0FBQyxlQUFlLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFFO0FBQ3hDLFFBQVEsT0FBTyxLQUFLLENBQUM7QUFDckIsS0FBSztBQUNMLElBQ0ksRUFBRSxDQUFDLEtBQUssQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDO0FBQ3BDLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxhQUFhLEdBQUcsR0FBRyxDQUFDO0FBQ2pDLElBQUksS0FBSyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUMxQjtBQUNBLFFBRFUsUUFB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QUFDb0IsSUFBaEIsdUNBQTBCO0FBQzlCO0FBQXFCLElBQWpCLG9DQUFzQjtBQUMxQjtBQUFxQixJQUFqQixrQ0FBa0I7QUFDdEI7QUFDTztBQUFpQjtBQUN0QjtBQUFRLElBRE4sNkNBQWlDO0FBQ3JDO0FBQVE7QUFBaUI7QUFBZ0I7QUFDdkMsSUFERSxtQ0FBMEM7QUFDOUM7QUFBUTtBQUNQO0FBQWdCO0FBQVEsSUFEckIsa0NBQW1CO0FBQ3ZCO0FBQVE7QUFBaUI7QUFBZ0I7QUFBUSxJQUM3Qyw2Q0FBbUM7QUFDdkM7QUFBUTtBQUFpQjtBQUN0QjtBQUFRLElBRFAsMkNBQWlDO0FBQ3JDO0FBQVE7QUFBaUI7QUFDVjtBQUFRLElBRG5CLHlDQUFxQjtBQUN6QjtBQUFRO0FBQ1I7QUFBZ0I7QUFBUSxJQURwQixvQ0FBb0I7QUFDeEI7QUFBUTtBQUFpQjtBQUFnQjtBQUN0QyxJQURDLHFEQUF5QztBQUM3QztBQUFRO0FBQ1A7QUFBZ0I7QUFBUSxJQURyQix1Q0FBbUI7QUFDdkI7QUFBUTtBQUFpQjtBQUNYO0FBQVEsSUFEbEIsMENBQXNCO0FBQzFCO0FBQVE7QUFBaUI7QUFFbEI7QUFBUSxJQUZYLDJDQUE0QjtBQUNoQztBQUNPO0FBQ0E7QUFBZ0I7QUFBUSxJQUF2QixnQ0FBOEI7QUFBQztBQUNoQztBQUFpQjtBQUNyQjtBQUFRLElBREgscUNBQTJCO0FBQUM7QUFDN0I7QUFBaUI7QUFDaEI7QUFBUSxJQURSLCtCQUFzQjtBQUFDO0FBQ3hCO0FBQWlCO0FBR3ZCO0FBQVEsSUFIRCxpQ0FBb0I7QUFDNUI7QUFBRTtBQUVLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBDb21wb25lbnQsXG4gICAgRWxlbWVudFJlZixcbiAgICBFdmVudEVtaXR0ZXIsXG4gICAgSW5wdXQsXG4gICAgTmdab25lLFxuICAgIE9uRGVzdHJveSxcbiAgICBPbkluaXQsXG4gICAgT3V0cHV0LFxuICAgIFJlbmRlcmVyMixcbiAgICBWaWV3Q29udGFpbmVyUmVmLFxuICAgIFZpZXdFbmNhcHN1bGF0aW9uXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgKiBhcyBoZWxwZXIgZnJvbSAnLi9uZXN0YWJsZS5oZWxwZXInO1xuXG5pbXBvcnQgeyBkZWZhdWx0U2V0dGluZ3MsIERSQUdfU1RBUlQsIEVYUEFORF9DT0xMQVBTRSwgbW91c2UsIFJFR0lTVEVSX0hBTkRMRSB9IGZyb20gJy4vbmVzdGFibGUuY29uc3RhbnQnO1xuXG5jb25zdCBQWCA9ICdweCc7XG5jb25zdCBoYXNQb2ludGVyRXZlbnRzID0gKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxuICAgICAgICBkb2NFbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcblxuICAgIGlmICghKCdwb2ludGVyRXZlbnRzJyBpbiBlbC5zdHlsZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGVsLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0byc7XG4gICAgZWwuc3R5bGUucG9pbnRlckV2ZW50cyA9ICd4JztcbiAgICBkb2NFbC5hcHBlbmRDaGlsZChlbCk7XG4gICAgY29uc3Qgc3VwcG9ydHMgPVxuICAgICAgICB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSAmJlxuICAgICAgICB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbCwgJycpLnBvaW50ZXJFdmVudHMgPT09ICdhdXRvJztcbiAgICBkb2NFbC5yZW1vdmVDaGlsZChlbCk7XG4gICAgcmV0dXJuICEhc3VwcG9ydHM7XG59KSgpO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ25neC1uZXN0YWJsZScsXG4gICAgdGVtcGxhdGVVcmw6ICcuL25lc3RhYmxlLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnLi9uZXN0YWJsZS5jb21wb25lbnQuc2NzcyddLFxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgTmVzdGFibGVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBsaXN0Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgZHJvcCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIGRyYWcgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBkaXNjbG9zdXJlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgQElucHV0KCkgcHVibGljIHRlbXBsYXRlOiBWaWV3Q29udGFpbmVyUmVmO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBvcHRpb25zID0gZGVmYXVsdFNldHRpbmdzO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBkaXNhYmxlRHJhZyA9IGZhbHNlO1xuXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgZ2V0IGxpc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9saXN0O1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXQgbGlzdChsaXN0KSB7XG4gICAgICAgIHRoaXMuX2xpc3QgPSBsaXN0O1xuICAgICAgICB0aGlzLl9nZW5lcmF0ZUl0ZW1JZHMoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZHJhZ1Jvb3RFbCA9IG51bGw7XG4gICAgcHVibGljIGRyYWdFbCA9IG51bGw7XG4gICAgcHVibGljIGRyYWdNb2RlbCA9IG51bGw7XG4gICAgcHVibGljIG1vdmluZyA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogRHJhZ2dlZCBlbGVtZW50IGNvbnRhaW5zIGNoaWxkcmVuLCBhbmQgdGhvc2UgY2hpbGRyZW4gY29udGFpbiBvdGhlciBjaGlsZHJlbiBhbmQgc28gb24uLi5cbiAgICAgKiBUaGlzIHByb3BlcnR5IGdpdmVzIHlvdSB0aGUgbnVtYmVyIG9mIGdlbmVyYXRpb25zIGNvbnRhaW5lZCB3aXRoaW4gdGhlIGRyYWdnaW5nIGl0ZW0uXG4gICAgICovXG4gICAgcHVibGljIGRyYWdEZXB0aCA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgZGVwdGggb2YgZHJhZ2dpbmcgaXRlbSByZWxhdGl2ZSB0byBlbGVtZW50IHJvb3QgKG5neC1uZXN0YWJsZSlcbiAgICAgKi9cbiAgICBwdWJsaWMgcmVsYXRpdmVEZXB0aCA9IDA7XG5cbiAgICBwdWJsaWMgaGFzTmV3Um9vdCA9IGZhbHNlO1xuICAgIHB1YmxpYyBwb2ludEVsID0gbnVsbDtcbiAgICBwdWJsaWMgaXRlbXMgPSBbXTtcblxuICAgIHByaXZhdGUgX2NvbXBvbmVudEFjdGl2ZSA9IGZhbHNlO1xuICAgIHByaXZhdGUgX21vdXNlID0gT2JqZWN0LmFzc2lnbih7fSwgbW91c2UpO1xuICAgIHByaXZhdGUgX2xpc3QgPSBbXTtcbiAgICAvLyBwcml2YXRlIF9vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdFNldHRpbmdzKSBhcyBOZXN0YWJsZVNldHRpbmdzO1xuICAgIHByaXZhdGUgX2NhbmNlbE1vdXNlbW92ZTogRnVuY3Rpb247XG4gICAgcHJpdmF0ZSBfY2FuY2VsTW91c2V1cDogRnVuY3Rpb247XG4gICAgcHJpdmF0ZSBfcGxhY2Vob2xkZXI7XG4gICAgcHJpdmF0ZSBfaXRlbUlkID0gMDtcbiAgICBwcml2YXRlIF9yZWdpc3RlckhhbmRsZURpcmVjdGl2ZSA9IGZhbHNlO1xuICAgIHByaXZhdGUgX2RyYWdJbmRleDtcbiAgICBwcml2YXRlIF9wYXJlbnREcmFnSWQ7XG4gICAgcHJpdmF0ZSBfb2xkTGlzdExlbmd0aDogYW55O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcmVmOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICAgICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLFxuICAgICAgICBwcml2YXRlIGVsOiBFbGVtZW50UmVmLFxuICAgICAgICBwcml2YXRlIHpvbmU6IE5nWm9uZVxuICAgICkge31cblxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xuICAgICAgICAvLyBzZXQvZXh0ZW5kIGRlZmF1bHQgb3B0aW9uc1xuICAgICAgICB0aGlzLl9jb21wb25lbnRBY3RpdmUgPSB0cnVlO1xuICAgICAgICBjb25zdCBvcHRpb25LZXlzID0gT2JqZWN0LmtleXMoZGVmYXVsdFNldHRpbmdzKTtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2Ygb3B0aW9uS2V5cykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnNba2V5XSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnNba2V5XSA9IGRlZmF1bHRTZXR0aW5nc1trZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fZ2VuZXJhdGVJdGVtSWRzKCk7XG4gICAgICAgIHRoaXMuX2dlbmVyYXRlSXRlbUV4cGFuZGVkKCk7XG4gICAgICAgIHRoaXMuX2NyZWF0ZUhhbmRsZUxpc3RlbmVyKCk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7fVxuXG4gICAgcHJpdmF0ZSBfZ2VuZXJhdGVJdGVtSWRzKCkge1xuICAgICAgICBoZWxwZXIuX3RyYXZlcnNlQ2hpbGRyZW4odGhpcy5fbGlzdCwgaXRlbSA9PiB7XG4gICAgICAgICAgICBpdGVtWyckJGlkJ10gPSB0aGlzLl9pdGVtSWQrKztcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfZ2VuZXJhdGVJdGVtRXhwYW5kZWQoKSB7XG4gICAgICAgIGhlbHBlci5fdHJhdmVyc2VDaGlsZHJlbih0aGlzLl9saXN0LCBpdGVtID0+IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbS5leHBhbmRlZCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBpdGVtWyckJGV4cGFuZGVkJ10gPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpdGVtWyckJGV4cGFuZGVkJ10gPSBpdGVtLmV4cGFuZGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9jcmVhdGVIYW5kbGVMaXN0ZW5lcigpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbC5uYXRpdmVFbGVtZW50LCBSRUdJU1RFUl9IQU5ETEUsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlZ2lzdGVySGFuZGxlRGlyZWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbC5uYXRpdmVFbGVtZW50LCBEUkFHX1NUQVJULCBkYXRhID0+IHtcbiAgICAgICAgICAgIHRoaXMuZHJhZ1N0YXJ0KFxuICAgICAgICAgICAgICAgIGRhdGEuZGV0YWlsLmV2ZW50LFxuICAgICAgICAgICAgICAgIGRhdGEuZGV0YWlsLnBhcmFtLml0ZW0sXG4gICAgICAgICAgICAgICAgZGF0YS5kZXRhaWwucGFyYW0ucGFyZW50TGlzdFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbC5uYXRpdmVFbGVtZW50LCBFWFBBTkRfQ09MTEFQU0UsIGRhdGEgPT4ge1xuICAgICAgICAgICAgdGhpcy5kaXNjbG9zdXJlLmVtaXQoe1xuICAgICAgICAgICAgICAgIGl0ZW06IGRhdGEuZGV0YWlsLml0ZW0sXG4gICAgICAgICAgICAgICAgZXhwYW5kZWQ6IGRhdGEuZGV0YWlsLml0ZW1bJyQkZXhwYW5kZWQnXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2NyZWF0ZURyYWdDbG9uZShldmVudCwgZHJhZ0l0ZW0pIHtcbiAgICAgICAgdGhpcy5fbW91c2VTdGFydChldmVudCwgZHJhZ0l0ZW0pO1xuXG4gICAgICAgIGlmICghdGhpcy5fcmVnaXN0ZXJIYW5kbGVEaXJlY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLm9mZnNldFkgPSBkcmFnSXRlbS5uZXh0RWxlbWVudFNpYmxpbmdcbiAgICAgICAgICAgICAgICA/IGRyYWdJdGVtLm5leHRFbGVtZW50U2libGluZy5jbGllbnRIZWlnaHQgLyAyXG4gICAgICAgICAgICAgICAgOiBkcmFnSXRlbS5jbGllbnRIZWlnaHQgLyAyO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY3JlYXRlIGRyYWcgY2xvbmVcbiAgICAgICAgdGhpcy5kcmFnRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZHJhZ0VsKTtcblxuICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMuZHJhZ0VsLCB0aGlzLm9wdGlvbnMuZHJhZ0NsYXNzKTtcblxuICAgICAgICAvLyBhZGQgZHJhZyBjbG9uZSB0byBib2R5IGFuZCBzZXQgY3NzXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgICAgICB0aGlzLmRyYWdFbCxcbiAgICAgICAgICAgICdsZWZ0JyxcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VYIC0gdGhpcy5fbW91c2Uub2Zmc2V0WCArIFBYXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgICAgICB0aGlzLmRyYWdFbCxcbiAgICAgICAgICAgICd0b3AnLFxuICAgICAgICAgICAgZXZlbnQucGFnZVkgLSB0aGlzLl9tb3VzZS5vZmZzZXRZICsgUFhcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmRyYWdFbCwgJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJyk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5kcmFnRWwsICd6LWluZGV4JywgOTk5OSk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5kcmFnRWwsICdwb2ludGVyLWV2ZW50cycsICdub25lJyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfY3JlYXRlUGxhY2Vob2xkZXIoZXZlbnQsIGRyYWdJdGVtKSB7XG4gICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLmNsYXNzTGlzdC5hZGQodGhpcy5vcHRpb25zLnBsYWNlQ2xhc3MpO1xuICAgICAgICBoZWxwZXIuX2luc2VydEFmdGVyKHRoaXMuX3BsYWNlaG9sZGVyLCBkcmFnSXRlbSk7XG4gICAgICAgIGRyYWdJdGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZHJhZ0l0ZW0pO1xuICAgICAgICB0aGlzLmRyYWdFbC5hcHBlbmRDaGlsZChkcmFnSXRlbSk7XG4gICAgICAgIHRoaXMuZHJhZ1Jvb3RFbCA9IGRyYWdJdGVtO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgZGVwdGggcHJvZXJ0aWVzIChyZWxhdGl2ZSBhbmQgZHJhZylcbiAgICAgKi9cbiAgICBwcml2YXRlIF9jYWxjdWxhdGVEZXB0aCgpIHtcbiAgICAgICAgLy8gdG90YWwgZGVwdGggb2YgZHJhZ2dpbmcgaXRlbVxuICAgICAgICBsZXQgZGVwdGg7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5kcmFnRWwucXVlcnlTZWxlY3RvckFsbCh0aGlzLm9wdGlvbnMuaXRlbU5vZGVOYW1lKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZGVwdGggPSBoZWxwZXIuX2dldFBhcmVudHMoaXRlbXNbaV0sIHRoaXMuZHJhZ0VsKS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAoZGVwdGggPiB0aGlzLmRyYWdEZXB0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ0RlcHRoID0gZGVwdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkZXB0aCByZWxhdGl2ZSB0byByb290XG4gICAgICAgIHRoaXMucmVsYXRpdmVEZXB0aCA9IGhlbHBlci5fZ2V0UGFyZW50cyhcbiAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLFxuICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZSlcbiAgICAgICAgKS5sZW5ndGg7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfbW91c2VTdGFydChldmVudCwgZHJhZ0l0ZW0pIHtcbiAgICAgICAgdGhpcy5fbW91c2Uub2Zmc2V0WCA9IGV2ZW50LnBhZ2VYIC0gaGVscGVyLl9vZmZzZXQoZHJhZ0l0ZW0pLmxlZnQ7XG4gICAgICAgIHRoaXMuX21vdXNlLm9mZnNldFkgPSBldmVudC5wYWdlWSAtIGhlbHBlci5fb2Zmc2V0KGRyYWdJdGVtKS50b3A7XG4gICAgICAgIHRoaXMuX21vdXNlLnN0YXJ0WCA9IHRoaXMuX21vdXNlLmxhc3RYID0gZXZlbnQucGFnZVg7XG4gICAgICAgIHRoaXMuX21vdXNlLnN0YXJ0WSA9IHRoaXMuX21vdXNlLmxhc3RZID0gZXZlbnQucGFnZVk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfbW91c2VVcGRhdGUoZXZlbnQpIHtcbiAgICAgICAgLy8gbW91c2UgcG9zaXRpb24gbGFzdCBldmVudHNcbiAgICAgICAgdGhpcy5fbW91c2UubGFzdFggPSB0aGlzLl9tb3VzZS5ub3dYO1xuICAgICAgICB0aGlzLl9tb3VzZS5sYXN0WSA9IHRoaXMuX21vdXNlLm5vd1k7XG4gICAgICAgIC8vIG1vdXNlIHBvc2l0aW9uIHRoaXMgZXZlbnRzXG4gICAgICAgIHRoaXMuX21vdXNlLm5vd1ggPSBldmVudC5wYWdlWDtcbiAgICAgICAgdGhpcy5fbW91c2Uubm93WSA9IGV2ZW50LnBhZ2VZO1xuICAgICAgICAvLyBkaXN0YW5jZSBtb3VzZSBtb3ZlZCBiZXR3ZWVuIGV2ZW50c1xuICAgICAgICB0aGlzLl9tb3VzZS5kaXN0WCA9IHRoaXMuX21vdXNlLm5vd1ggLSB0aGlzLl9tb3VzZS5sYXN0WDtcbiAgICAgICAgdGhpcy5fbW91c2UuZGlzdFkgPSB0aGlzLl9tb3VzZS5ub3dZIC0gdGhpcy5fbW91c2UubGFzdFk7XG4gICAgICAgIC8vIGRpcmVjdGlvbiBtb3VzZSB3YXMgbW92aW5nXG4gICAgICAgIHRoaXMuX21vdXNlLmxhc3REaXJYID0gdGhpcy5fbW91c2UuZGlyWDtcbiAgICAgICAgdGhpcy5fbW91c2UubGFzdERpclkgPSB0aGlzLl9tb3VzZS5kaXJZO1xuICAgICAgICAvLyBkaXJlY3Rpb24gbW91c2UgaXMgbm93IG1vdmluZyAob24gYm90aCBheGlzKVxuICAgICAgICB0aGlzLl9tb3VzZS5kaXJYID1cbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RYID09PSAwID8gMCA6IHRoaXMuX21vdXNlLmRpc3RYID4gMCA/IDEgOiAtMTtcbiAgICAgICAgdGhpcy5fbW91c2UuZGlyWSA9XG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5kaXN0WSA9PT0gMCA/IDAgOiB0aGlzLl9tb3VzZS5kaXN0WSA+IDAgPyAxIDogLTE7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfc2hvd01hc2tzKCkge1xuICAgICAgICBjb25zdCBtYXNrcyA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICAgJ25lc3RhYmxlLWl0ZW0tbWFzaydcbiAgICAgICAgKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbWFza3NbaV0uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIF9oaWRlTWFza3MoKSB7XG4gICAgICAgIGNvbnN0IG1hc2tzID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgICAnbmVzdGFibGUtaXRlbS1tYXNrJ1xuICAgICAgICApO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hc2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBtYXNrc1tpXS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY2FsYyBtb3VzZSB0cmF2ZXJzZSBkaXN0YW5jZSBvbiBheGlzXG4gICAgICogQHBhcmFtIG0gLSBtb3VzZVxuICAgICAqL1xuICAgIHByaXZhdGUgX2NhbGNNb3VzZURpc3RhbmNlKG0pIHtcbiAgICAgICAgbS5kaXN0QXhYICs9IE1hdGguYWJzKG0uZGlzdFgpO1xuICAgICAgICBpZiAobS5kaXJYICE9PSAwICYmIG0uZGlyWCAhPT0gbS5sYXN0RGlyWCkge1xuICAgICAgICAgICAgbS5kaXN0QXhYID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIG0uZGlzdEF4WSArPSBNYXRoLmFicyhtLmRpc3RZKTtcbiAgICAgICAgaWYgKG0uZGlyWSAhPT0gMCAmJiBtLmRpclkgIT09IG0ubGFzdERpclkpIHtcbiAgICAgICAgICAgIG0uZGlzdEF4WSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIF9tb3ZlKGV2ZW50KSB7XG4gICAgICAgIGxldCBkZXB0aCwgbGlzdDtcblxuICAgICAgICBjb25zdCBkcmFnUmVjdCA9IHRoaXMuZHJhZ0VsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgICAgdGhpcy5kcmFnRWwsXG4gICAgICAgICAgICAnbGVmdCcsXG4gICAgICAgICAgICBldmVudC5wYWdlWCAtIHRoaXMuX21vdXNlLm9mZnNldFggKyBQWFxuICAgICAgICApO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgICAgdGhpcy5kcmFnRWwsXG4gICAgICAgICAgICAndG9wJyxcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VZIC0gdGhpcy5fbW91c2Uub2Zmc2V0WSArIFBYXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5fbW91c2VVcGRhdGUoZXZlbnQpO1xuXG4gICAgICAgIC8vIGF4aXMgbW91c2UgaXMgbm93IG1vdmluZyBvblxuICAgICAgICBjb25zdCBuZXdBeCA9XG4gICAgICAgICAgICBNYXRoLmFicyh0aGlzLl9tb3VzZS5kaXN0WCkgPiBNYXRoLmFicyh0aGlzLl9tb3VzZS5kaXN0WSkgPyAxIDogMDtcblxuICAgICAgICAvLyBkbyBub3RoaW5nIG9uIGZpcnN0IG1vdmVcbiAgICAgICAgaWYgKCF0aGlzLl9tb3VzZS5tb3ZpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpckF4ID0gbmV3QXg7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5tb3ZpbmcgPSAxO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2FsYyBkaXN0YW5jZSBtb3ZlZCBvbiB0aGlzIGF4aXMgKGFuZCBkaXJlY3Rpb24pXG4gICAgICAgIGlmICh0aGlzLl9tb3VzZS5kaXJBeCAhPT0gbmV3QXgpIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RBeFggPSAwO1xuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlzdEF4WSA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jYWxjTW91c2VEaXN0YW5jZSh0aGlzLl9tb3VzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbW91c2UuZGlyQXggPSBuZXdBeDtcblxuICAgICAgICAvLyBmaW5kIGxpc3QgaXRlbSB1bmRlciBjdXJzb3JcbiAgICAgICAgaWYgKCFoYXNQb2ludGVyRXZlbnRzKSB7XG4gICAgICAgICAgICB0aGlzLmRyYWdFbC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwb2ludEVsID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VYIC0gZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0LFxuICAgICAgICAgICAgZXZlbnQucGFnZVkgLSAod2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKCFoYXNQb2ludGVyRXZlbnRzKSB7XG4gICAgICAgICAgICB0aGlzLmRyYWdFbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgcG9pbnRFbCAmJlxuICAgICAgICAgICAgKHBvaW50RWwuY2xhc3NMaXN0LmNvbnRhaW5zKCduZXN0YWJsZS1pdGVtLW1hc2snKSB8fFxuICAgICAgICAgICAgICAgIHBvaW50RWwuY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMub3B0aW9ucy5wbGFjZUNsYXNzKSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLnBvaW50RWwgPSBwb2ludEVsLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBtb3ZlIGhvcml6b250YWxcbiAgICAgICAgICovXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICF0aGlzLm9wdGlvbnMuZml4ZWREZXB0aCAmJlxuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlyQXggJiZcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RBeFggPj0gdGhpcy5vcHRpb25zLnRocmVzaG9sZFxuICAgICAgICApIHtcbiAgICAgICAgICAgIC8vIHJlc2V0IG1vdmUgZGlzdGFuY2Ugb24geC1heGlzIGZvciBuZXcgcGhhc2VcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RBeFggPSAwO1xuICAgICAgICAgICAgY29uc3QgcHJldmlvdXMgPSB0aGlzLl9wbGFjZWhvbGRlci5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAvLyBpbmNyZWFzZSBob3Jpem9udGFsIGxldmVsIGlmIHByZXZpb3VzIHNpYmxpbmcgZXhpc3RzLCBpcyBub3QgY29sbGFwc2VkLCBhbmQgY2FuIGhhdmUgY2hpbGRyZW5cbiAgICAgICAgICAgIGlmICh0aGlzLl9tb3VzZS5kaXN0WCA+IDAgJiYgcHJldmlvdXMpIHtcbiAgICAgICAgICAgICAgICBsaXN0ID0gcHJldmlvdXMucXVlcnlTZWxlY3RvckFsbCh0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKTtcbiAgICAgICAgICAgICAgICBsaXN0ID0gbGlzdFtsaXN0Lmxlbmd0aCAtIDFdO1xuXG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgZGVwdGggbGltaXQgaGFzIHJlYWNoZWRcbiAgICAgICAgICAgICAgICBkZXB0aCA9IGhlbHBlci5fZ2V0UGFyZW50cyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUpXG4gICAgICAgICAgICAgICAgKS5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBpZiAoZGVwdGggKyB0aGlzLmRyYWdEZXB0aCA8PSB0aGlzLm9wdGlvbnMubWF4RGVwdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyBzdWItbGV2ZWwgaWYgb25lIGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFsaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Quc3R5bGUucGFkZGluZ0xlZnQgPSB0aGlzLm9wdGlvbnMudGhyZXNob2xkICsgUFg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKHRoaXMuX3BsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzLmFwcGVuZENoaWxkKGxpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zZXRQYXJlbnQocHJldmlvdXMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxzZSBhcHBlbmQgdG8gbmV4dCBsZXZlbCB1cFxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCA9IHByZXZpb3VzLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYDpzY29wZSA+ICR7IHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUgfWBcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKHRoaXMuX3BsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGRlY3JlYXNlIGhvcml6b250YWwgbGV2ZWxcbiAgICAgICAgICAgIGlmICh0aGlzLl9tb3VzZS5kaXN0WCA8IDApIHtcbiAgICAgICAgICAgICAgICAvLyB3ZSBjYW4ndCBkZWNyZWFzZSBhIGxldmVsIGlmIGFuIGl0ZW0gcHJlY2VlZHMgdGhlIGN1cnJlbnQgb25lXG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgICAgIGAuJHsgdGhpcy5vcHRpb25zLnBsYWNlQ2xhc3MgfSArICR7IHRoaXMub3B0aW9ucy5pdGVtTm9kZU5hbWUgfWBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEVsZW1lbnQgPSB0aGlzLl9wbGFjZWhvbGRlci5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmICghbmV4dCAmJiBwYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsb3Nlc3RJdGVtID0gaGVscGVyLl9jbG9zZXN0KFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuaXRlbU5vZGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsb3Nlc3RJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuX3BsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5faW5zZXJ0QWZ0ZXIodGhpcy5fcGxhY2Vob2xkZXIsIGNsb3Nlc3RJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcG9pbnRFbC5jbGFzc0xpc3QuY29udGFpbnMoJ25lc3RhYmxlLWl0ZW0tbWFzaycpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmaW5kIHJvb3QgbGlzdCBvZiBpdGVtIHVuZGVyIGN1cnNvclxuICAgICAgICBjb25zdCBwb2ludEVsUm9vdCA9IGhlbHBlci5fY2xvc2VzdChcbiAgICAgICAgICAgIHRoaXMucG9pbnRFbCxcbiAgICAgICAgICAgIGAuJHsgdGhpcy5vcHRpb25zLnJvb3RDbGFzcyB9YFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIGlzTmV3Um9vdCA9IHBvaW50RWxSb290XG4gICAgICAgICAgICAgICAgPyB0aGlzLmRyYWdSb290RWwuZGF0YXNldFsnbmVzdGFibGUtaWQnXSAhPT1cbiAgICAgICAgICAgICAgICBwb2ludEVsUm9vdC5kYXRhc2V0WyduZXN0YWJsZS1pZCddXG4gICAgICAgICAgICAgICAgOiBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogbW92ZSB2ZXJ0aWNhbFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCF0aGlzLl9tb3VzZS5kaXJBeCB8fCBpc05ld1Jvb3QpIHtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIGdyb3VwcyBtYXRjaCBpZiBkcmFnZ2luZyBvdmVyIG5ldyByb290XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgaXNOZXdSb290ICYmXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmdyb3VwICE9PSBwb2ludEVsUm9vdC5kYXRhc2V0WyduZXN0YWJsZS1ncm91cCddXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNoZWNrIGRlcHRoIGxpbWl0XG4gICAgICAgICAgICBkZXB0aCA9XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnRGVwdGggLVxuICAgICAgICAgICAgICAgIDEgK1xuICAgICAgICAgICAgICAgIGhlbHBlci5fZ2V0UGFyZW50cyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKVxuICAgICAgICAgICAgICAgICkubGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAoZGVwdGggPiB0aGlzLm9wdGlvbnMubWF4RGVwdGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGJlZm9yZSA9XG4gICAgICAgICAgICAgICAgZXZlbnQucGFnZVkgPFxuICAgICAgICAgICAgICAgIGhlbHBlci5fb2Zmc2V0KHRoaXMucG9pbnRFbCkudG9wICsgdGhpcy5wb2ludEVsLmNsaWVudEhlaWdodCAvIDI7XG4gICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlclBhcmVudCA9IHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudE5vZGU7XG5cbiAgICAgICAgICAgIC8vIGdldCBwb2ludCBlbGVtZW50IGRlcHRoXG4gICAgICAgICAgICBsZXQgcG9pbnRSZWxhdGl2ZURlcHRoO1xuICAgICAgICAgICAgcG9pbnRSZWxhdGl2ZURlcHRoID0gaGVscGVyLl9nZXRQYXJlbnRzKFxuICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbCxcbiAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKVxuICAgICAgICAgICAgKS5sZW5ndGg7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZml4ZWREZXB0aCkge1xuICAgICAgICAgICAgICAgIGlmIChwb2ludFJlbGF0aXZlRGVwdGggPT09IHRoaXMucmVsYXRpdmVEZXB0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGRMaXN0ID0gdGhpcy5wb2ludEVsLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hpbGRMaXN0LmNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRMaXN0LmFwcGVuZENoaWxkKHRoaXMuX3BsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocG9pbnRSZWxhdGl2ZURlcHRoID09PSB0aGlzLnJlbGF0aXZlRGVwdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJlZm9yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5faW5zZXJ0QWZ0ZXIodGhpcy5fcGxhY2Vob2xkZXIsIHRoaXMucG9pbnRFbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbC5wYXJlbnRFbGVtZW50LmNoaWxkcmVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbFxuICAgICAgICAgICAgICAgICAgICAgICAgKSA9PT1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbC5wYXJlbnRFbGVtZW50LmNoaWxkcmVuLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuX2luc2VydEFmdGVyKHRoaXMuX3BsYWNlaG9sZGVyLCB0aGlzLnBvaW50RWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChiZWZvcmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWwucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoZWxwZXIuX2luc2VydEFmdGVyKHRoaXMuX3BsYWNlaG9sZGVyLCB0aGlzLnBvaW50RWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHJlc2V0KCkge1xuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5fbW91c2UpO1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZVtrZXldID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2l0ZW1JZCA9IDA7XG4gICAgICAgIHRoaXMubW92aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZHJhZ0VsID0gbnVsbDtcbiAgICAgICAgdGhpcy5kcmFnUm9vdEVsID0gbnVsbDtcbiAgICAgICAgdGhpcy5kcmFnRGVwdGggPSAwO1xuICAgICAgICB0aGlzLnJlbGF0aXZlRGVwdGggPSAwO1xuICAgICAgICB0aGlzLmhhc05ld1Jvb3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wb2ludEVsID0gbnVsbDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZHJhZ1N0YXJ0RnJvbUl0ZW0oZXZlbnQsIGl0ZW0sIHBhcmVudExpc3QpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9yZWdpc3RlckhhbmRsZURpcmVjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5kcmFnU3RhcnQoZXZlbnQsIGl0ZW0sIHBhcmVudExpc3QpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkcmFnU3RhcnQoZXZlbnQsIGl0ZW0sIHBhcmVudExpc3QpIHtcblxuICAgICAgICB0aGlzLl9vbGRMaXN0TGVuZ3RoID0gdGhpcy5saXN0Lmxlbmd0aDtcblxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5kaXNhYmxlRHJhZykge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50ID0gZXZlbnQub3JpZ2luYWxFdmVudDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWxsb3cgb25seSBmaXJzdCBtb3VzZSBidXR0b25cbiAgICAgICAgICAgIGlmIChldmVudC50eXBlLmluZGV4T2YoJ21vdXNlJykgPT09IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuYnV0dG9uICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC50b3VjaGVzLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnJlZi5kZXRhY2goKTtcbiAgICAgICAgICAgIHRoaXMuX2RyYWdJbmRleCA9IHBhcmVudExpc3QuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ01vZGVsID0gcGFyZW50TGlzdC5zcGxpY2UocGFyZW50TGlzdC5pbmRleE9mKGl0ZW0pLCAxKVswXTtcblxuICAgICAgICAgICAgY29uc3QgZHJhZ0l0ZW0gPSBoZWxwZXIuX2Nsb3Nlc3QoZXZlbnQudGFyZ2V0LCB0aGlzLm9wdGlvbnMuaXRlbU5vZGVOYW1lKTtcbiAgICAgICAgICAgIGlmIChkcmFnSXRlbSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3BhcmVudERyYWdJZCA9IE51bWJlci5wYXJzZUludChcbiAgICAgICAgICAgICAgICBkcmFnSXRlbS5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuaWRcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRyYWdSZWN0ID0gZHJhZ0l0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgICAgIHRoaXMuX3Nob3dNYXNrcygpO1xuICAgICAgICAgICAgdGhpcy5fY3JlYXRlRHJhZ0Nsb25lKGV2ZW50LCBkcmFnSXRlbSk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZHJhZ0VsLCAnd2lkdGgnLCBkcmFnUmVjdC53aWR0aCArIFBYKTtcblxuICAgICAgICAgICAgdGhpcy5fY3JlYXRlUGxhY2Vob2xkZXIoZXZlbnQsIGRyYWdJdGVtKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fcGxhY2Vob2xkZXIsICdoZWlnaHQnLCBkcmFnUmVjdC5oZWlnaHQgKyBQWCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZURlcHRoKCk7XG4gICAgICAgICAgICB0aGlzLmRyYWcuZW1pdCh7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZlbnQsXG4gICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX2NhbmNlbE1vdXNldXAgPSB0aGlzLnJlbmRlcmVyLmxpc3RlbihcbiAgICAgICAgICAgICAgICBkb2N1bWVudCxcbiAgICAgICAgICAgICAgICAnbW91c2V1cCcsXG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnU3RvcC5iaW5kKHRoaXMpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5fY2FuY2VsTW91c2Vtb3ZlID0gdGhpcy5yZW5kZXJlci5saXN0ZW4oXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgJ21vdXNlbW92ZScsXG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnTW92ZS5iaW5kKHRoaXMpXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGRyYWdTdG9wKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuX2NhbmNlbE1vdXNldXAoKTtcbiAgICAgICAgdGhpcy5fY2FuY2VsTW91c2Vtb3ZlKCk7XG4gICAgICAgIHRoaXMuX2hpZGVNYXNrcygpO1xuXG4gICAgICAgIGlmICh0aGlzLmRyYWdFbCkge1xuICAgICAgICAgICAgY29uc3QgZHJhZ2dlZElkID0gTnVtYmVyLnBhcnNlSW50KHRoaXMuZHJhZ0VsLmZpcnN0RWxlbWVudENoaWxkLmlkKTtcbiAgICAgICAgICAgIGxldCBwbGFjZWhvbGRlckNvbnRhaW5lciA9IGhlbHBlci5fY2xvc2VzdChcbiAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlcixcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuaXRlbU5vZGVOYW1lXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBsZXQgY2hhbmdlZEVsZW1lbnRQb3NpdGlvbiA9XG4gICAgICAgICAgICAgICAgdGhpcy5fZHJhZ0luZGV4ICE9PVxuICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4sIHRoaXMuX3BsYWNlaG9sZGVyKTtcblxuICAgICAgICAgICAgaWYgKCh0aGlzLl9kcmFnSW5kZXggPT09IGluZGV4KSAmJiAodGhpcy5fb2xkTGlzdExlbmd0aCA9PT0gdGhpcy5saXN0Lmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VkRWxlbWVudFBvc2l0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcGxhY2Vob2xkZXIgaW4gcm9vdFxuICAgICAgICAgICAgaWYgKHBsYWNlaG9sZGVyQ29udGFpbmVyID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0LnNwbGljZShcbiAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgICB7IC4uLnRoaXMuZHJhZ01vZGVsIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBwYWxjZWhvbGRlciBuZXN0ZWRcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlckNvbnRhaW5lciA9IGhlbHBlci5fZmluZE9iamVjdEluVHJlZShcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0LFxuICAgICAgICAgICAgICAgICAgICBOdW1iZXIucGFyc2VJbnQocGxhY2Vob2xkZXJDb250YWluZXIuaWQpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBpZiAoIXBsYWNlaG9sZGVyQ29udGFpbmVyLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyQ29udGFpbmVyLmNoaWxkcmVuID0gW107XG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyQ29udGFpbmVyLmNoaWxkcmVuLnB1c2goeyAuLi50aGlzLmRyYWdNb2RlbCB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlckNvbnRhaW5lci5jaGlsZHJlbi5zcGxpY2UoXG4gICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyAuLi50aGlzLmRyYWdNb2RlbCB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gdGhpcy5fZHJhZ0luZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWRFbGVtZW50UG9zaXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFjaGFuZ2VkRWxlbWVudFBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWRFbGVtZW50UG9zaXRpb24gPVxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJDb250YWluZXJbJyQkaWQnXSAhPT0gdGhpcy5fcGFyZW50RHJhZ0lkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLl9wbGFjZWhvbGRlcik7XG4gICAgICAgICAgICB0aGlzLmRyYWdFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZHJhZ0VsKTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgICAgICB0aGlzLmxpc3RDaGFuZ2UuZW1pdCh0aGlzLmxpc3QpO1xuICAgICAgICAgICAgdGhpcy5kcm9wLmVtaXQoe1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uOiBwbGFjZWhvbGRlckNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBpdGVtOiB0aGlzLmRyYWdNb2RlbCxcbiAgICAgICAgICAgICAgICBjaGFuZ2VkRWxlbWVudFBvc2l0aW9uXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucmVmLnJlYXR0YWNoKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZHJhZ01vdmUoZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuZHJhZ0VsKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50ID0gZXZlbnQub3JpZ2luYWxFdmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX21vdmUoZXZlbnQudHlwZS5pbmRleE9mKCdtb3VzZScpID09PSAwID8gZXZlbnQgOiBldmVudC50b3VjaGVzWzBdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBleHBhbmRBbGwoKSB7XG4gICAgICAgIGhlbHBlci5fdHJhdmVyc2VDaGlsZHJlbih0aGlzLl9saXN0LCBpdGVtID0+IHtcbiAgICAgICAgICAgIGl0ZW1bJyQkZXhwYW5kZWQnXSA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY29sbGFwc2VBbGwoKSB7XG4gICAgICAgIGhlbHBlci5fdHJhdmVyc2VDaGlsZHJlbih0aGlzLl9saXN0LCBpdGVtID0+IHtcbiAgICAgICAgICAgIGl0ZW1bJyQkZXhwYW5kZWQnXSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZWYubWFya0ZvckNoZWNrKCk7XG4gICAgfVxufVxuIl19