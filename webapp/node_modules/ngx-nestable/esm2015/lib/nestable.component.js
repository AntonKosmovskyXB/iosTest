/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, NgZone, Output, Renderer2, ViewContainerRef, ViewEncapsulation } from '@angular/core';
import * as helper from './nestable.helper';
import { defaultSettings, DRAG_START, EXPAND_COLLAPSE, mouse, REGISTER_HANDLE } from './nestable.constant';
/** @type {?} */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';

function NestableComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function NestableComponent_ng_template_1_li_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function NestableComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
const _c0 = function (a0, a1) { return { nestable: a0, depth: a1 }; };
function NestableComponent_ng_template_1_li_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r8 = ɵngcc0.ɵɵnextContext().$implicit;
    const depth_r6 = ɵngcc0.ɵɵnextContext().depth;
    ɵngcc0.ɵɵnextContext();
    const _r1 = ɵngcc0.ɵɵreference(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r1)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c0, item_r8.children, depth_r6 + 1));
} }
const _c1 = function (a0, a1, a2) { return { nestable: a0, item: a1, depth: a2 }; };
function NestableComponent_ng_template_1_li_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "li", 4);
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵtemplate(2, NestableComponent_ng_template_1_li_1_ng_container_2_Template, 2, 5, "ng-container", 5);
    ɵngcc0.ɵɵelement(3, "ul");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r8 = ctx.$implicit;
    const ctx_r14 = ɵngcc0.ɵɵnextContext();
    const nestable_r5 = ctx_r14.nestable;
    const depth_r6 = ctx_r14.depth;
    const ctx_r7 = ɵngcc0.ɵɵnextContext();
    const _r3 = ɵngcc0.ɵɵreference(4);
    ɵngcc0.ɵɵclassMap(ctx_r7.options.itemClass);
    ɵngcc0.ɵɵproperty("id", item_r8.$$id);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r3)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction3(10, _c1, nestable_r5, item_r8, depth_r6));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", item_r8.children && item_r8.$$expanded);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵclassMap(ctx_r7.options.listClass);
    ɵngcc0.ɵɵstyleProp("padding-left", ctx_r7.options.threshold, "px");
} }
function NestableComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "ul");
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_Template, 4, 14, "li", 3);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const nestable_r5 = ctx.nestable;
    const depth_r6 = ctx.depth;
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassMap(ctx_r2.options.listClass);
    ɵngcc0.ɵɵstyleProp("padding-left", depth_r6 ? ctx_r2.options.threshold : 0, "px");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", nestable_r5);
} }
function NestableComponent_ng_template_3_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
const _c2 = function (a0, a1) { return { item: a0, parentList: a1 }; };
const _c3 = function (a0, a1) { return { $implicit: a0, depth: a1 }; };
function NestableComponent_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    const _r20 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 6);
    ɵngcc0.ɵɵlistener("mousedown", function NestableComponent_ng_template_3_Template_div_mousedown_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r20); const item_r16 = ctx.item; const parentList_r15 = ctx.nestable; const ctx_r19 = ɵngcc0.ɵɵnextContext(); return ctx_r19.dragStartFromItem($event, item_r16, parentList_r15); });
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_3_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelement(2, "div", 7);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const parentList_r15 = ctx.nestable;
    const item_r16 = ctx.item;
    const depth_r17 = ctx.depth;
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r4.template)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(5, _c3, ɵngcc0.ɵɵpureFunction2(2, _c2, item_r16, parentList_r15), depth_r17));
} }
const _c4 = function (a0) { return { nestable: a0, depth: 0 }; };
const PX = 'px';
const ɵ0 = /**
 * @return {?}
 */
function () {
    /** @type {?} */
    const el = document.createElement('div');
    /** @type {?} */
    const docEl = document.documentElement;
    if (!('pointerEvents' in el.style)) {
        return false;
    }
    el.style.pointerEvents = 'auto';
    el.style.pointerEvents = 'x';
    docEl.appendChild(el);
    /** @type {?} */
    const supports = window.getComputedStyle &&
        window.getComputedStyle(el, '').pointerEvents === 'auto';
    docEl.removeChild(el);
    return !!supports;
};
/** @type {?} */
const hasPointerEvents = ((ɵ0))();
export class NestableComponent {
    /**
     * @param {?} ref
     * @param {?} renderer
     * @param {?} el
     * @param {?} zone
     */
    constructor(ref, renderer, el, zone) {
        this.ref = ref;
        this.renderer = renderer;
        this.el = el;
        this.zone = zone;
        this.listChange = new EventEmitter();
        this.drop = new EventEmitter();
        this.drag = new EventEmitter();
        this.disclosure = new EventEmitter();
        this.options = defaultSettings;
        this.disableDrag = false;
        this.dragRootEl = null;
        this.dragEl = null;
        this.dragModel = null;
        this.moving = false;
        /**
         * Dragged element contains children, and those children contain other children and so on...
         * This property gives you the number of generations contained within the dragging item.
         */
        this.dragDepth = 0;
        /**
         * The depth of dragging item relative to element root (ngx-nestable)
         */
        this.relativeDepth = 0;
        this.hasNewRoot = false;
        this.pointEl = null;
        this.items = [];
        this._componentActive = false;
        this._mouse = Object.assign({}, mouse);
        this._list = [];
        this._itemId = 0;
        this._registerHandleDirective = false;
    }
    /**
     * @return {?}
     */
    get list() {
        return this._list;
    }
    /**
     * @param {?} list
     * @return {?}
     */
    set list(list) {
        this._list = list;
        this._generateItemIds();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // set/extend default options
        this._componentActive = true;
        /** @type {?} */
        const optionKeys = Object.keys(defaultSettings);
        for (const key of optionKeys) {
            if (typeof this.options[key] === 'undefined') {
                this.options[key] = defaultSettings[key];
            }
        }
        this._generateItemIds();
        this._generateItemExpanded();
        this._createHandleListener();
    }
    /**
     * @return {?}
     */
    ngOnDestroy() { }
    /**
     * @private
     * @return {?}
     */
    _generateItemIds() {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        item => {
            item['$$id'] = this._itemId++;
        }));
    }
    /**
     * @private
     * @return {?}
     */
    _generateItemExpanded() {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        item => {
            if (typeof item.expanded === 'undefined') {
                item['$$expanded'] = true;
            }
            else {
                item['$$expanded'] = item.expanded;
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    _createHandleListener() {
        this.renderer.listen(this.el.nativeElement, REGISTER_HANDLE, (/**
         * @return {?}
         */
        () => {
            this._registerHandleDirective = true;
        }));
        this.renderer.listen(this.el.nativeElement, DRAG_START, (/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.dragStart(data.detail.event, data.detail.param.item, data.detail.param.parentList);
        }));
        this.renderer.listen(this.el.nativeElement, EXPAND_COLLAPSE, (/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.disclosure.emit({
                item: data.detail.item,
                expanded: data.detail.item['$$expanded']
            });
        }));
    }
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    _createDragClone(event, dragItem) {
        this._mouseStart(event, dragItem);
        if (!this._registerHandleDirective) {
            this._mouse.offsetY = dragItem.nextElementSibling
                ? dragItem.nextElementSibling.clientHeight / 2
                : dragItem.clientHeight / 2;
        }
        // create drag clone
        this.dragEl = document.createElement(this.options.listNodeName);
        document.body.appendChild(this.dragEl);
        this.renderer.addClass(this.dragEl, this.options.dragClass);
        // add drag clone to body and set css
        this.renderer.setStyle(this.dragEl, 'left', event.pageX - this._mouse.offsetX + PX);
        this.renderer.setStyle(this.dragEl, 'top', event.pageY - this._mouse.offsetY + PX);
        this.renderer.setStyle(this.dragEl, 'position', 'absolute');
        this.renderer.setStyle(this.dragEl, 'z-index', 9999);
        this.renderer.setStyle(this.dragEl, 'pointer-events', 'none');
    }
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    _createPlaceholder(event, dragItem) {
        this._placeholder = document.createElement('div');
        this._placeholder.classList.add(this.options.placeClass);
        helper._insertAfter(this._placeholder, dragItem);
        dragItem.parentNode.removeChild(dragItem);
        this.dragEl.appendChild(dragItem);
        this.dragRootEl = dragItem;
    }
    /**
     * Sets depth proerties (relative and drag)
     * @private
     * @return {?}
     */
    _calculateDepth() {
        // total depth of dragging item
        /** @type {?} */
        let depth;
        /** @type {?} */
        const items = this.dragEl.querySelectorAll(this.options.itemNodeName);
        for (let i = 0; i < items.length; i++) {
            depth = helper._getParents(items[i], this.dragEl).length;
            if (depth > this.dragDepth) {
                this.dragDepth = depth;
            }
        }
        // depth relative to root
        this.relativeDepth = helper._getParents(this._placeholder, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
    }
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    _mouseStart(event, dragItem) {
        this._mouse.offsetX = event.pageX - helper._offset(dragItem).left;
        this._mouse.offsetY = event.pageY - helper._offset(dragItem).top;
        this._mouse.startX = this._mouse.lastX = event.pageX;
        this._mouse.startY = this._mouse.lastY = event.pageY;
    }
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    _mouseUpdate(event) {
        // mouse position last events
        this._mouse.lastX = this._mouse.nowX;
        this._mouse.lastY = this._mouse.nowY;
        // mouse position this events
        this._mouse.nowX = event.pageX;
        this._mouse.nowY = event.pageY;
        // distance mouse moved between events
        this._mouse.distX = this._mouse.nowX - this._mouse.lastX;
        this._mouse.distY = this._mouse.nowY - this._mouse.lastY;
        // direction mouse was moving
        this._mouse.lastDirX = this._mouse.dirX;
        this._mouse.lastDirY = this._mouse.dirY;
        // direction mouse is now moving (on both axis)
        this._mouse.dirX =
            this._mouse.distX === 0 ? 0 : this._mouse.distX > 0 ? 1 : -1;
        this._mouse.dirY =
            this._mouse.distY === 0 ? 0 : this._mouse.distY > 0 ? 1 : -1;
    }
    /**
     * @private
     * @return {?}
     */
    _showMasks() {
        /** @type {?} */
        const masks = this.el.nativeElement.getElementsByClassName('nestable-item-mask');
        for (let i = 0; i < masks.length; i++) {
            masks[i].style.display = 'block';
        }
    }
    /**
     * @private
     * @return {?}
     */
    _hideMasks() {
        /** @type {?} */
        const masks = this.el.nativeElement.getElementsByClassName('nestable-item-mask');
        for (let i = 0; i < masks.length; i++) {
            masks[i].style.display = 'none';
        }
    }
    /**
     * calc mouse traverse distance on axis
     * @private
     * @param {?} m - mouse
     * @return {?}
     */
    _calcMouseDistance(m) {
        m.distAxX += Math.abs(m.distX);
        if (m.dirX !== 0 && m.dirX !== m.lastDirX) {
            m.distAxX = 0;
        }
        m.distAxY += Math.abs(m.distY);
        if (m.dirY !== 0 && m.dirY !== m.lastDirY) {
            m.distAxY = 0;
        }
    }
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    _move(event) {
        /** @type {?} */
        let depth;
        /** @type {?} */
        let list;
        /** @type {?} */
        const dragRect = this.dragEl.getBoundingClientRect();
        this.renderer.setStyle(this.dragEl, 'left', event.pageX - this._mouse.offsetX + PX);
        this.renderer.setStyle(this.dragEl, 'top', event.pageY - this._mouse.offsetY + PX);
        this._mouseUpdate(event);
        // axis mouse is now moving on
        /** @type {?} */
        const newAx = Math.abs(this._mouse.distX) > Math.abs(this._mouse.distY) ? 1 : 0;
        // do nothing on first move
        if (!this._mouse.moving) {
            this._mouse.dirAx = newAx;
            this._mouse.moving = 1;
            return;
        }
        // calc distance moved on this axis (and direction)
        if (this._mouse.dirAx !== newAx) {
            this._mouse.distAxX = 0;
            this._mouse.distAxY = 0;
        }
        else {
            this._calcMouseDistance(this._mouse);
        }
        this._mouse.dirAx = newAx;
        // find list item under cursor
        if (!hasPointerEvents) {
            this.dragEl.style.visibility = 'hidden';
        }
        /** @type {?} */
        const pointEl = document.elementFromPoint(event.pageX - document.body.scrollLeft, event.pageY - (window.pageYOffset || document.documentElement.scrollTop));
        if (!hasPointerEvents) {
            this.dragEl.style.visibility = 'visible';
        }
        if (pointEl &&
            (pointEl.classList.contains('nestable-item-mask') ||
                pointEl.classList.contains(this.options.placeClass))) {
            this.pointEl = pointEl.parentElement.parentElement;
        }
        else {
            return;
        }
        /**
         * move horizontal
         */
        if (!this.options.fixedDepth &&
            this._mouse.dirAx &&
            this._mouse.distAxX >= this.options.threshold) {
            // reset move distance on x-axis for new phase
            this._mouse.distAxX = 0;
            /** @type {?} */
            const previous = this._placeholder.previousElementSibling;
            // increase horizontal level if previous sibling exists, is not collapsed, and can have children
            if (this._mouse.distX > 0 && previous) {
                list = previous.querySelectorAll(this.options.listNodeName);
                list = list[list.length - 1];
                // check if depth limit has reached
                depth = helper._getParents(this._placeholder, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
                if (depth + this.dragDepth <= this.options.maxDepth) {
                    // create new sub-level if one doesn't exist
                    if (!list) {
                        list = document.createElement(this.options.listNodeName);
                        list.style.paddingLeft = this.options.threshold + PX;
                        list.appendChild(this._placeholder);
                        previous.appendChild(list);
                        // this.setParent(previous);
                    }
                    else {
                        // else append to next level up
                        list = previous.querySelector(`:scope > ${this.options.listNodeName}`);
                        list.appendChild(this._placeholder);
                    }
                }
            }
            // decrease horizontal level
            if (this._mouse.distX < 0) {
                // we can't decrease a level if an item preceeds the current one
                /** @type {?} */
                const next = document.querySelector(`.${this.options.placeClass} + ${this.options.itemNodeName}`);
                /** @type {?} */
                const parentElement = this._placeholder.parentElement;
                if (!next && parentElement) {
                    /** @type {?} */
                    const closestItem = helper._closest(this._placeholder, this.options.itemNodeName);
                    if (closestItem) {
                        parentElement.removeChild(this._placeholder);
                        helper._insertAfter(this._placeholder, closestItem);
                    }
                }
            }
        }
        if (!pointEl.classList.contains('nestable-item-mask')) {
            return;
        }
        // find root list of item under cursor
        /** @type {?} */
        const pointElRoot = helper._closest(this.pointEl, `.${this.options.rootClass}`);
        /** @type {?} */
        const isNewRoot = pointElRoot
            ? this.dragRootEl.dataset['nestable-id'] !==
                pointElRoot.dataset['nestable-id']
            : false;
        /**
         * move vertical
         */
        if (!this._mouse.dirAx || isNewRoot) {
            // check if groups match if dragging over new root
            if (isNewRoot &&
                this.options.group !== pointElRoot.dataset['nestable-group']) {
                return;
            }
            // check depth limit
            depth =
                this.dragDepth -
                    1 +
                    helper._getParents(this.pointEl, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
            if (depth > this.options.maxDepth) {
                return;
            }
            /** @type {?} */
            const before = event.pageY <
                helper._offset(this.pointEl).top + this.pointEl.clientHeight / 2;
            /** @type {?} */
            const placeholderParent = this._placeholder.parentNode;
            // get point element depth
            /** @type {?} */
            let pointRelativeDepth;
            pointRelativeDepth = helper._getParents(this.pointEl, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
            if (this.options.fixedDepth) {
                if (pointRelativeDepth === this.relativeDepth - 1) {
                    /** @type {?} */
                    const childList = this.pointEl.querySelector(this.options.listNodeName);
                    if (!childList.children.length) {
                        childList.appendChild(this._placeholder);
                    }
                }
                else if (pointRelativeDepth === this.relativeDepth) {
                    if (before) {
                        this.pointEl.parentElement.insertBefore(this._placeholder, this.pointEl);
                    }
                    else {
                        helper._insertAfter(this._placeholder, this.pointEl);
                    }
                    if (Array.prototype.indexOf.call(this.pointEl.parentElement.children, this.pointEl) ===
                        this.pointEl.parentElement.children.length - 1) {
                        helper._insertAfter(this._placeholder, this.pointEl);
                    }
                }
            }
            else if (before) {
                this.pointEl.parentElement.insertBefore(this._placeholder, this.pointEl);
            }
            else {
                helper._insertAfter(this._placeholder, this.pointEl);
            }
        }
    }
    /**
     * @return {?}
     */
    reset() {
        /** @type {?} */
        const keys = Object.keys(this._mouse);
        for (const key of keys) {
            this._mouse[key] = 0;
        }
        this._itemId = 0;
        this.moving = false;
        this.dragEl = null;
        this.dragRootEl = null;
        this.dragDepth = 0;
        this.relativeDepth = 0;
        this.hasNewRoot = false;
        this.pointEl = null;
    }
    /**
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    dragStartFromItem(event, item, parentList) {
        if (!this._registerHandleDirective) {
            this.dragStart(event, item, parentList);
        }
    }
    /**
     * @private
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    dragStart(event, item, parentList) {
        this._oldListLength = this.list.length;
        if (!this.options.disableDrag) {
            event.stopPropagation();
            event.preventDefault();
            if (event.originalEvent) {
                event = event.originalEvent;
            }
            // allow only first mouse button
            if (event.type.indexOf('mouse') === 0) {
                if (event.button !== 0) {
                    return;
                }
            }
            else {
                if (event.touches.length !== 1) {
                    return;
                }
            }
            this.ref.detach();
            this._dragIndex = parentList.indexOf(item);
            this.dragModel = parentList.splice(parentList.indexOf(item), 1)[0];
            /** @type {?} */
            const dragItem = helper._closest(event.target, this.options.itemNodeName);
            if (dragItem === null) {
                return;
            }
            this._parentDragId = Number.parseInt(dragItem.parentElement.parentElement.id);
            /** @type {?} */
            const dragRect = dragItem.getBoundingClientRect();
            this._showMasks();
            this._createDragClone(event, dragItem);
            this.renderer.setStyle(this.dragEl, 'width', dragRect.width + PX);
            this._createPlaceholder(event, dragItem);
            this.renderer.setStyle(this._placeholder, 'height', dragRect.height + PX);
            this._calculateDepth();
            this.drag.emit({
                originalEvent: event,
                item
            });
            this._cancelMouseup = this.renderer.listen(document, 'mouseup', this.dragStop.bind(this));
            this._cancelMousemove = this.renderer.listen(document, 'mousemove', this.dragMove.bind(this));
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    dragStop(event) {
        this._cancelMouseup();
        this._cancelMousemove();
        this._hideMasks();
        if (this.dragEl) {
            /** @type {?} */
            const draggedId = Number.parseInt(this.dragEl.firstElementChild.id);
            /** @type {?} */
            let placeholderContainer = helper._closest(this._placeholder, this.options.itemNodeName);
            /** @type {?} */
            let changedElementPosition = this._dragIndex !==
                Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder);
            /** @type {?} */
            const index = Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder);
            if ((this._dragIndex === index) && (this._oldListLength === this.list.length)) {
                changedElementPosition = true;
            }
            // placeholder in root
            if (placeholderContainer === null) {
                this.list.splice(Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder), 0, Object.assign({}, this.dragModel));
            }
            else {
                // palceholder nested
                placeholderContainer = helper._findObjectInTree(this.list, Number.parseInt(placeholderContainer.id));
                if (!placeholderContainer.children) {
                    placeholderContainer.children = [];
                    placeholderContainer.children.push(Object.assign({}, this.dragModel));
                }
                else {
                    placeholderContainer.children.splice(Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder), 0, Object.assign({}, this.dragModel));
                }
                if (index === this._dragIndex) {
                    changedElementPosition = false;
                }
                if (!changedElementPosition) {
                    changedElementPosition =
                        placeholderContainer['$$id'] !== this._parentDragId;
                }
            }
            this._placeholder.parentElement.removeChild(this._placeholder);
            this.dragEl.parentNode.removeChild(this.dragEl);
            this.dragEl.remove();
            this.reset();
            this.listChange.emit(this.list);
            this.drop.emit({
                originalEvent: event,
                destination: placeholderContainer,
                item: this.dragModel,
                changedElementPosition
            });
            this.ref.reattach();
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    dragMove(event) {
        if (this.dragEl) {
            event.preventDefault();
            if (event.originalEvent) {
                event = event.originalEvent;
            }
            this._move(event.type.indexOf('mouse') === 0 ? event : event.touches[0]);
        }
    }
    /**
     * @return {?}
     */
    expandAll() {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        item => {
            item['$$expanded'] = true;
        }));
        this.ref.markForCheck();
    }
    /**
     * @return {?}
     */
    collapseAll() {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        item => {
            item['$$expanded'] = false;
        }));
        this.ref.markForCheck();
    }
}
NestableComponent.ɵfac = function NestableComponent_Factory(t) { return new (t || NestableComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };
NestableComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: NestableComponent, selectors: [["ngx-nestable"]], inputs: { options: "options", disableDrag: "disableDrag", list: "list", template: "template" }, outputs: { listChange: "listChange", drop: "drop", drag: "drag", disclosure: "disclosure" }, decls: 5, vars: 4, consts: [[4, "ngTemplateOutlet", "ngTemplateOutletContext"], ["nestableList", ""], ["nestableItem", ""], [3, "class", "id", 4, "ngFor", "ngForOf"], [3, "id"], [4, "ngIf"], [1, "nestable-item-container", "mat-list-item", 3, "mousedown"], [1, "nestable-item-mask"]], template: function NestableComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, NestableComponent_ng_container_0_Template, 1, 0, "ng-container", 0);
        ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_Template, 2, 5, "ng-template", null, 1, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(3, NestableComponent_ng_template_3_Template, 3, 8, "ng-template", null, 2, ɵngcc0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r1 = ɵngcc0.ɵɵreference(2);
        ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r1)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c4, ctx.list));
    } }, directives: [ɵngcc1.NgTemplateOutlet, ɵngcc1.NgForOf, ɵngcc1.NgIf], styles: ["@import url(https://fonts.googleapis.com/css?family=Roboto);ul .dd-placeholder{margin:5px 0;padding:0;min-height:30px;background:#f2fbff;border:1px dashed #b6bcbf;box-sizing:border-box}ul li .nestable-item-mask{display:none;position:absolute;top:0;bottom:0;right:0;left:0;z-index:9998}ul li .nestable-expand-button{display:block;position:relative;cursor:pointer;float:left;width:25px;height:14px;padding:0;white-space:nowrap;overflow:hidden;border:0;background:0 0;font-size:18px;line-height:1;text-align:center;font-weight:700;outline:0}ul li .nestable-item-container{position:relative;display:flex;flex-direction:row;align-items:center;color:rgba(0,0,0,.87);min-height:32px;font-size:16px;font-family:Roboto,sans-serif;cursor:pointer;outline:0;margin-bottom:2px;padding-left:8px}ul li .nestable-item-container:hover{background:rgba(0,0,0,.04)}ol,ul{list-style:none}"], encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
NestableComponent.ctorParameters = () => [
    { type: ChangeDetectorRef },
    { type: Renderer2 },
    { type: ElementRef },
    { type: NgZone }
];
NestableComponent.propDecorators = {
    listChange: [{ type: Output }],
    drop: [{ type: Output }],
    drag: [{ type: Output }],
    disclosure: [{ type: Output }],
    template: [{ type: Input }],
    options: [{ type: Input }],
    disableDrag: [{ type: Input }],
    list: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(NestableComponent, [{
        type: Component,
        args: [{
                selector: 'ngx-nestable',
                template: "<ng-container *ngTemplateOutlet=\"nestableList; context:{nestable: list, depth: 0}\">\n</ng-container>\n\n<ng-template #nestableList let-nestable=\"nestable\" let-depth=\"depth\">\n    <ul [style.padding-left.px]=\"depth ? options.threshold : 0\"\n        [class]=\"options.listClass\">\n        <li [class]=\"options.itemClass\" [id]=\"item.$$id\" *ngFor=\"let item of nestable\">\n\n            <ng-container *ngTemplateOutlet=\"nestableItem; context:{nestable: nestable, item: item, depth: depth}\">\n            </ng-container>\n\n            <ng-container *ngIf=\"item.children && item.$$expanded\">\n                <ng-container *ngTemplateOutlet=\"nestableList; context:{nestable: item.children, depth: depth + 1}\">\n                </ng-container>\n            </ng-container>\n\n            <ul [class]=\"options.listClass\" [style.padding-left.px]=\"options.threshold\"></ul>\n        </li>\n    </ul>\n</ng-template>\n\n<ng-template #nestableItem let-parentList=\"nestable\" let-item=\"item\" let-depth=\"depth\">\n    <div class=\"nestable-item-container mat-list-item\" (mousedown)=\"dragStartFromItem($event, item, parentList)\">\n        <ng-container\n            *ngTemplateOutlet=\"template; context:{$implicit: {item: item, parentList: parentList}, depth: depth}\">\n        </ng-container>\n\n        <div class=\"nestable-item-mask\"></div>\n    </div>\n</ng-template>\n",
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: ["@import url(https://fonts.googleapis.com/css?family=Roboto);ul .dd-placeholder{margin:5px 0;padding:0;min-height:30px;background:#f2fbff;border:1px dashed #b6bcbf;box-sizing:border-box}ul li .nestable-item-mask{display:none;position:absolute;top:0;bottom:0;right:0;left:0;z-index:9998}ul li .nestable-expand-button{display:block;position:relative;cursor:pointer;float:left;width:25px;height:14px;padding:0;white-space:nowrap;overflow:hidden;border:0;background:0 0;font-size:18px;line-height:1;text-align:center;font-weight:700;outline:0}ul li .nestable-item-container{position:relative;display:flex;flex-direction:row;align-items:center;color:rgba(0,0,0,.87);min-height:32px;font-size:16px;font-family:Roboto,sans-serif;cursor:pointer;outline:0;margin-bottom:2px;padding-left:8px}ul li .nestable-item-container:hover{background:rgba(0,0,0,.04)}ol,ul{list-style:none}"]
            }]
    }], function () { return [{ type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.NgZone }]; }, { listChange: [{
            type: Output
        }], drop: [{
            type: Output
        }], drag: [{
            type: Output
        }], disclosure: [{
            type: Output
        }], options: [{
            type: Input
        }], disableDrag: [{
            type: Input
        }], list: [{
            type: Input
        }], template: [{
            type: Input
        }] }); })();
if (false) {
    /** @type {?} */
    NestableComponent.prototype.listChange;
    /** @type {?} */
    NestableComponent.prototype.drop;
    /** @type {?} */
    NestableComponent.prototype.drag;
    /** @type {?} */
    NestableComponent.prototype.disclosure;
    /** @type {?} */
    NestableComponent.prototype.template;
    /** @type {?} */
    NestableComponent.prototype.options;
    /** @type {?} */
    NestableComponent.prototype.disableDrag;
    /** @type {?} */
    NestableComponent.prototype.dragRootEl;
    /** @type {?} */
    NestableComponent.prototype.dragEl;
    /** @type {?} */
    NestableComponent.prototype.dragModel;
    /** @type {?} */
    NestableComponent.prototype.moving;
    /**
     * Dragged element contains children, and those children contain other children and so on...
     * This property gives you the number of generations contained within the dragging item.
     * @type {?}
     */
    NestableComponent.prototype.dragDepth;
    /**
     * The depth of dragging item relative to element root (ngx-nestable)
     * @type {?}
     */
    NestableComponent.prototype.relativeDepth;
    /** @type {?} */
    NestableComponent.prototype.hasNewRoot;
    /** @type {?} */
    NestableComponent.prototype.pointEl;
    /** @type {?} */
    NestableComponent.prototype.items;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._componentActive;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._mouse;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._list;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._cancelMousemove;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._cancelMouseup;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._placeholder;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._itemId;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._registerHandleDirective;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._dragIndex;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._parentDragId;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._oldListLength;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.ref;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.zone;
}
export { ɵ0 };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmVzdGFibGUuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyJuZzovbmd4LW5lc3RhYmxlL2xpYi9uZXN0YWJsZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCx1QkFBdUIsRUFDdkIsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLEtBQUssRUFDTCxNQUFNLEVBR04sTUFBTSxFQUNOLFNBQVMsRUFDVCxnQkFBZ0IsRUFDaEIsaUJBQWlCLEVBQ3BCLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sS0FBSyxNQUFNLE1BQU0sbUJBQW1CLENBQUM7QUFFNUMsT0FBTyxFQUFFLGVBQWUsRUFBRSxVQUFVLEVBQUUsZUFBZSxFQUFFLEtBQUssRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMzRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ2dCLE1BQVYsRUFBRSxHQUFHLElBQUk7QUFDZjtBQUFlO0FBQWU7QUFBSjtBQUMxQjtBQUFxQixVQUFYLEVBQUUsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQztBQUM1QztBQUFxQixVQUFiLEtBQUssR0FBRyxRQUFRLENBQUMsZUFBZTtBQUN4QyxJQUNJLElBQUksQ0FBQyxDQUFDLGVBQWUsSUFBSSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUU7QUFDeEMsUUFBUSxPQUFPLEtBQUssQ0FBQztBQUNyQixLQUFLO0FBQ0wsSUFDSSxFQUFFLENBQUMsS0FBSyxDQUFDLGFBQWEsR0FBRyxNQUFNLENBQUM7QUFDcEMsSUFBSSxFQUFFLENBQUMsS0FBSyxDQUFDLGFBQWEsR0FBRyxHQUFHLENBQUM7QUFDakMsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQzFCO0FBQ0EsVUFEVSxRQUFR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Q0FBc0I7QUFDMUI7QUFBcUIsSUFBakIsa0NBQWtCO0FBQ3RCO0FBQ087QUFBaUI7QUFDdEI7QUFBUSxJQUROLDZDQUFpQztBQUNyQztBQUFRO0FBQWlCO0FBQWdCO0FBQ3ZDLElBREUsbUNBQTBDO0FBQzlDO0FBQVE7QUFDUDtBQUFnQjtBQUFRLElBRHJCLGtDQUFtQjtBQUN2QjtBQUFRO0FBQWlCO0FBQWdCO0FBQVEsSUFDN0MsNkNBQW1DO0FBQ3ZDO0FBQVE7QUFBaUI7QUFDdEI7QUFBUSxJQURQLDJDQUFpQztBQUNyQztBQUFRO0FBQWlCO0FBQ1Y7QUFBUSxJQURuQix5Q0FBcUI7QUFDekI7QUFBUTtBQUNSO0FBQWdCO0FBQVEsSUFEcEIsb0NBQW9CO0FBQ3hCO0FBQVE7QUFBaUI7QUFBZ0I7QUFDdEMsSUFEQyxxREFBeUM7QUFDN0M7QUFBUTtBQUNQO0FBQWdCO0FBQVEsSUFEckIsdUNBQW1CO0FBQ3ZCO0FBQVE7QUFBaUI7QUFDWDtBQUFRLElBRGxCLDBDQUFzQjtBQUMxQjtBQUFRO0FBQWlCO0FBRWxCO0FBQVEsSUFGWCwyQ0FBNEI7QUFDaEM7QUFDTztBQUNBO0FBQWdCO0FBQVEsSUFBdkIsZ0NBQThCO0FBQUM7QUFDaEM7QUFBaUI7QUFDckI7QUFBUSxJQURILHFDQUEyQjtBQUFDO0FBQzdCO0FBQWlCO0FBQ2hCO0FBQVEsSUFEUiwrQkFBc0I7QUFBQztBQUN4QjtBQUFpQjtBQUd2QjtBQUFRLElBSEQsaUNBQW9CO0FBQzVCO0FBQUU7QUFFSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gICAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgQ29tcG9uZW50LFxuICAgIEVsZW1lbnRSZWYsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIElucHV0LFxuICAgIE5nWm9uZSxcbiAgICBPbkRlc3Ryb3ksXG4gICAgT25Jbml0LFxuICAgIE91dHB1dCxcbiAgICBSZW5kZXJlcjIsXG4gICAgVmlld0NvbnRhaW5lclJlZixcbiAgICBWaWV3RW5jYXBzdWxhdGlvblxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0ICogYXMgaGVscGVyIGZyb20gJy4vbmVzdGFibGUuaGVscGVyJztcblxuaW1wb3J0IHsgZGVmYXVsdFNldHRpbmdzLCBEUkFHX1NUQVJULCBFWFBBTkRfQ09MTEFQU0UsIG1vdXNlLCBSRUdJU1RFUl9IQU5ETEUgfSBmcm9tICcuL25lc3RhYmxlLmNvbnN0YW50JztcblxuY29uc3QgUFggPSAncHgnO1xuY29uc3QgaGFzUG9pbnRlckV2ZW50cyA9IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcbiAgICAgICAgZG9jRWwgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cbiAgICBpZiAoISgncG9pbnRlckV2ZW50cycgaW4gZWwuc3R5bGUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBlbC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nO1xuICAgIGVsLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAneCc7XG4gICAgZG9jRWwuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIGNvbnN0IHN1cHBvcnRzID1cbiAgICAgICAgd2luZG93LmdldENvbXB1dGVkU3R5bGUgJiZcbiAgICAgICAgd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwsICcnKS5wb2ludGVyRXZlbnRzID09PSAnYXV0byc7XG4gICAgZG9jRWwucmVtb3ZlQ2hpbGQoZWwpO1xuICAgIHJldHVybiAhIXN1cHBvcnRzO1xufSkoKTtcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICduZ3gtbmVzdGFibGUnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9uZXN0YWJsZS5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vbmVzdGFibGUuY29tcG9uZW50LnNjc3MnXSxcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXG59KVxuZXhwb3J0IGNsYXNzIE5lc3RhYmxlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgbGlzdENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIGRyb3AgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBkcmFnID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgZGlzY2xvc3VyZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAgIEBJbnB1dCgpIHB1YmxpYyB0ZW1wbGF0ZTogVmlld0NvbnRhaW5lclJlZjtcbiAgICBASW5wdXQoKSBwdWJsaWMgb3B0aW9ucyA9IGRlZmF1bHRTZXR0aW5ncztcbiAgICBASW5wdXQoKSBwdWJsaWMgZGlzYWJsZURyYWcgPSBmYWxzZTtcblxuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGdldCBsaXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGlzdDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0IGxpc3QobGlzdCkge1xuICAgICAgICB0aGlzLl9saXN0ID0gbGlzdDtcbiAgICAgICAgdGhpcy5fZ2VuZXJhdGVJdGVtSWRzKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGRyYWdSb290RWwgPSBudWxsO1xuICAgIHB1YmxpYyBkcmFnRWwgPSBudWxsO1xuICAgIHB1YmxpYyBkcmFnTW9kZWwgPSBudWxsO1xuICAgIHB1YmxpYyBtb3ZpbmcgPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIERyYWdnZWQgZWxlbWVudCBjb250YWlucyBjaGlsZHJlbiwgYW5kIHRob3NlIGNoaWxkcmVuIGNvbnRhaW4gb3RoZXIgY2hpbGRyZW4gYW5kIHNvIG9uLi4uXG4gICAgICogVGhpcyBwcm9wZXJ0eSBnaXZlcyB5b3UgdGhlIG51bWJlciBvZiBnZW5lcmF0aW9ucyBjb250YWluZWQgd2l0aGluIHRoZSBkcmFnZ2luZyBpdGVtLlxuICAgICAqL1xuICAgIHB1YmxpYyBkcmFnRGVwdGggPSAwO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGRlcHRoIG9mIGRyYWdnaW5nIGl0ZW0gcmVsYXRpdmUgdG8gZWxlbWVudCByb290IChuZ3gtbmVzdGFibGUpXG4gICAgICovXG4gICAgcHVibGljIHJlbGF0aXZlRGVwdGggPSAwO1xuXG4gICAgcHVibGljIGhhc05ld1Jvb3QgPSBmYWxzZTtcbiAgICBwdWJsaWMgcG9pbnRFbCA9IG51bGw7XG4gICAgcHVibGljIGl0ZW1zID0gW107XG5cbiAgICBwcml2YXRlIF9jb21wb25lbnRBY3RpdmUgPSBmYWxzZTtcbiAgICBwcml2YXRlIF9tb3VzZSA9IE9iamVjdC5hc3NpZ24oe30sIG1vdXNlKTtcbiAgICBwcml2YXRlIF9saXN0ID0gW107XG4gICAgLy8gcHJpdmF0ZSBfb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRTZXR0aW5ncykgYXMgTmVzdGFibGVTZXR0aW5ncztcbiAgICBwcml2YXRlIF9jYW5jZWxNb3VzZW1vdmU6IEZ1bmN0aW9uO1xuICAgIHByaXZhdGUgX2NhbmNlbE1vdXNldXA6IEZ1bmN0aW9uO1xuICAgIHByaXZhdGUgX3BsYWNlaG9sZGVyO1xuICAgIHByaXZhdGUgX2l0ZW1JZCA9IDA7XG4gICAgcHJpdmF0ZSBfcmVnaXN0ZXJIYW5kbGVEaXJlY3RpdmUgPSBmYWxzZTtcbiAgICBwcml2YXRlIF9kcmFnSW5kZXg7XG4gICAgcHJpdmF0ZSBfcGFyZW50RHJhZ0lkO1xuICAgIHByaXZhdGUgX29sZExpc3RMZW5ndGg6IGFueTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHJlZjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMixcbiAgICAgICAgcHJpdmF0ZSBlbDogRWxlbWVudFJlZixcbiAgICAgICAgcHJpdmF0ZSB6b25lOiBOZ1pvbmVcbiAgICApIHt9XG5cbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICAgICAgLy8gc2V0L2V4dGVuZCBkZWZhdWx0IG9wdGlvbnNcbiAgICAgICAgdGhpcy5fY29tcG9uZW50QWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgY29uc3Qgb3B0aW9uS2V5cyA9IE9iamVjdC5rZXlzKGRlZmF1bHRTZXR0aW5ncyk7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIG9wdGlvbktleXMpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zW2tleV0gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zW2tleV0gPSBkZWZhdWx0U2V0dGluZ3Nba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2dlbmVyYXRlSXRlbUlkcygpO1xuICAgICAgICB0aGlzLl9nZW5lcmF0ZUl0ZW1FeHBhbmRlZCgpO1xuICAgICAgICB0aGlzLl9jcmVhdGVIYW5kbGVMaXN0ZW5lcigpO1xuICAgIH1cblxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge31cblxuICAgIHByaXZhdGUgX2dlbmVyYXRlSXRlbUlkcygpIHtcbiAgICAgICAgaGVscGVyLl90cmF2ZXJzZUNoaWxkcmVuKHRoaXMuX2xpc3QsIGl0ZW0gPT4ge1xuICAgICAgICAgICAgaXRlbVsnJCRpZCddID0gdGhpcy5faXRlbUlkKys7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2dlbmVyYXRlSXRlbUV4cGFuZGVkKCkge1xuICAgICAgICBoZWxwZXIuX3RyYXZlcnNlQ2hpbGRyZW4odGhpcy5fbGlzdCwgaXRlbSA9PiB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0uZXhwYW5kZWQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgaXRlbVsnJCRleHBhbmRlZCddID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaXRlbVsnJCRleHBhbmRlZCddID0gaXRlbS5leHBhbmRlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfY3JlYXRlSGFuZGxlTGlzdGVuZXIoKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgUkVHSVNURVJfSEFORExFLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9yZWdpc3RlckhhbmRsZURpcmVjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgRFJBR19TVEFSVCwgZGF0YSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRyYWdTdGFydChcbiAgICAgICAgICAgICAgICBkYXRhLmRldGFpbC5ldmVudCxcbiAgICAgICAgICAgICAgICBkYXRhLmRldGFpbC5wYXJhbS5pdGVtLFxuICAgICAgICAgICAgICAgIGRhdGEuZGV0YWlsLnBhcmFtLnBhcmVudExpc3RcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgRVhQQU5EX0NPTExBUFNFLCBkYXRhID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGlzY2xvc3VyZS5lbWl0KHtcbiAgICAgICAgICAgICAgICBpdGVtOiBkYXRhLmRldGFpbC5pdGVtLFxuICAgICAgICAgICAgICAgIGV4cGFuZGVkOiBkYXRhLmRldGFpbC5pdGVtWyckJGV4cGFuZGVkJ11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9jcmVhdGVEcmFnQ2xvbmUoZXZlbnQsIGRyYWdJdGVtKSB7XG4gICAgICAgIHRoaXMuX21vdXNlU3RhcnQoZXZlbnQsIGRyYWdJdGVtKTtcblxuICAgICAgICBpZiAoIXRoaXMuX3JlZ2lzdGVySGFuZGxlRGlyZWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5vZmZzZXRZID0gZHJhZ0l0ZW0ubmV4dEVsZW1lbnRTaWJsaW5nXG4gICAgICAgICAgICAgICAgPyBkcmFnSXRlbS5uZXh0RWxlbWVudFNpYmxpbmcuY2xpZW50SGVpZ2h0IC8gMlxuICAgICAgICAgICAgICAgIDogZHJhZ0l0ZW0uY2xpZW50SGVpZ2h0IC8gMjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNyZWF0ZSBkcmFnIGNsb25lXG4gICAgICAgIHRoaXMuZHJhZ0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmRyYWdFbCk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmRyYWdFbCwgdGhpcy5vcHRpb25zLmRyYWdDbGFzcyk7XG5cbiAgICAgICAgLy8gYWRkIGRyYWcgY2xvbmUgdG8gYm9keSBhbmQgc2V0IGNzc1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgICAgdGhpcy5kcmFnRWwsXG4gICAgICAgICAgICAnbGVmdCcsXG4gICAgICAgICAgICBldmVudC5wYWdlWCAtIHRoaXMuX21vdXNlLm9mZnNldFggKyBQWFxuICAgICAgICApO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgICAgdGhpcy5kcmFnRWwsXG4gICAgICAgICAgICAndG9wJyxcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VZIC0gdGhpcy5fbW91c2Uub2Zmc2V0WSArIFBYXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5kcmFnRWwsICdwb3NpdGlvbicsICdhYnNvbHV0ZScpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZHJhZ0VsLCAnei1pbmRleCcsIDk5OTkpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZHJhZ0VsLCAncG9pbnRlci1ldmVudHMnLCAnbm9uZScpO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2NyZWF0ZVBsYWNlaG9sZGVyKGV2ZW50LCBkcmFnSXRlbSkge1xuICAgICAgICB0aGlzLl9wbGFjZWhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLl9wbGFjZWhvbGRlci5jbGFzc0xpc3QuYWRkKHRoaXMub3B0aW9ucy5wbGFjZUNsYXNzKTtcbiAgICAgICAgaGVscGVyLl9pbnNlcnRBZnRlcih0aGlzLl9wbGFjZWhvbGRlciwgZHJhZ0l0ZW0pO1xuICAgICAgICBkcmFnSXRlbS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRyYWdJdGVtKTtcbiAgICAgICAgdGhpcy5kcmFnRWwuYXBwZW5kQ2hpbGQoZHJhZ0l0ZW0pO1xuICAgICAgICB0aGlzLmRyYWdSb290RWwgPSBkcmFnSXRlbTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIGRlcHRoIHByb2VydGllcyAocmVsYXRpdmUgYW5kIGRyYWcpXG4gICAgICovXG4gICAgcHJpdmF0ZSBfY2FsY3VsYXRlRGVwdGgoKSB7XG4gICAgICAgIC8vIHRvdGFsIGRlcHRoIG9mIGRyYWdnaW5nIGl0ZW1cbiAgICAgICAgbGV0IGRlcHRoO1xuICAgICAgICBjb25zdCBpdGVtcyA9IHRoaXMuZHJhZ0VsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5vcHRpb25zLml0ZW1Ob2RlTmFtZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGRlcHRoID0gaGVscGVyLl9nZXRQYXJlbnRzKGl0ZW1zW2ldLCB0aGlzLmRyYWdFbCkubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKGRlcHRoID4gdGhpcy5kcmFnRGVwdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWdEZXB0aCA9IGRlcHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gZGVwdGggcmVsYXRpdmUgdG8gcm9vdFxuICAgICAgICB0aGlzLnJlbGF0aXZlRGVwdGggPSBoZWxwZXIuX2dldFBhcmVudHMoXG4gICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlcixcbiAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUpXG4gICAgICAgICkubGVuZ3RoO1xuICAgIH1cblxuICAgIHByaXZhdGUgX21vdXNlU3RhcnQoZXZlbnQsIGRyYWdJdGVtKSB7XG4gICAgICAgIHRoaXMuX21vdXNlLm9mZnNldFggPSBldmVudC5wYWdlWCAtIGhlbHBlci5fb2Zmc2V0KGRyYWdJdGVtKS5sZWZ0O1xuICAgICAgICB0aGlzLl9tb3VzZS5vZmZzZXRZID0gZXZlbnQucGFnZVkgLSBoZWxwZXIuX29mZnNldChkcmFnSXRlbSkudG9wO1xuICAgICAgICB0aGlzLl9tb3VzZS5zdGFydFggPSB0aGlzLl9tb3VzZS5sYXN0WCA9IGV2ZW50LnBhZ2VYO1xuICAgICAgICB0aGlzLl9tb3VzZS5zdGFydFkgPSB0aGlzLl9tb3VzZS5sYXN0WSA9IGV2ZW50LnBhZ2VZO1xuICAgIH1cblxuICAgIHByaXZhdGUgX21vdXNlVXBkYXRlKGV2ZW50KSB7XG4gICAgICAgIC8vIG1vdXNlIHBvc2l0aW9uIGxhc3QgZXZlbnRzXG4gICAgICAgIHRoaXMuX21vdXNlLmxhc3RYID0gdGhpcy5fbW91c2Uubm93WDtcbiAgICAgICAgdGhpcy5fbW91c2UubGFzdFkgPSB0aGlzLl9tb3VzZS5ub3dZO1xuICAgICAgICAvLyBtb3VzZSBwb3NpdGlvbiB0aGlzIGV2ZW50c1xuICAgICAgICB0aGlzLl9tb3VzZS5ub3dYID0gZXZlbnQucGFnZVg7XG4gICAgICAgIHRoaXMuX21vdXNlLm5vd1kgPSBldmVudC5wYWdlWTtcbiAgICAgICAgLy8gZGlzdGFuY2UgbW91c2UgbW92ZWQgYmV0d2VlbiBldmVudHNcbiAgICAgICAgdGhpcy5fbW91c2UuZGlzdFggPSB0aGlzLl9tb3VzZS5ub3dYIC0gdGhpcy5fbW91c2UubGFzdFg7XG4gICAgICAgIHRoaXMuX21vdXNlLmRpc3RZID0gdGhpcy5fbW91c2Uubm93WSAtIHRoaXMuX21vdXNlLmxhc3RZO1xuICAgICAgICAvLyBkaXJlY3Rpb24gbW91c2Ugd2FzIG1vdmluZ1xuICAgICAgICB0aGlzLl9tb3VzZS5sYXN0RGlyWCA9IHRoaXMuX21vdXNlLmRpclg7XG4gICAgICAgIHRoaXMuX21vdXNlLmxhc3REaXJZID0gdGhpcy5fbW91c2UuZGlyWTtcbiAgICAgICAgLy8gZGlyZWN0aW9uIG1vdXNlIGlzIG5vdyBtb3ZpbmcgKG9uIGJvdGggYXhpcylcbiAgICAgICAgdGhpcy5fbW91c2UuZGlyWCA9XG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5kaXN0WCA9PT0gMCA/IDAgOiB0aGlzLl9tb3VzZS5kaXN0WCA+IDAgPyAxIDogLTE7XG4gICAgICAgIHRoaXMuX21vdXNlLmRpclkgPVxuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlzdFkgPT09IDAgPyAwIDogdGhpcy5fbW91c2UuZGlzdFkgPiAwID8gMSA6IC0xO1xuICAgIH1cblxuICAgIHByaXZhdGUgX3Nob3dNYXNrcygpIHtcbiAgICAgICAgY29uc3QgbWFza3MgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcbiAgICAgICAgICAgICduZXN0YWJsZS1pdGVtLW1hc2snXG4gICAgICAgICk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFza3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG1hc2tzW2ldLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfaGlkZU1hc2tzKCkge1xuICAgICAgICBjb25zdCBtYXNrcyA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICAgJ25lc3RhYmxlLWl0ZW0tbWFzaydcbiAgICAgICAgKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbWFza3NbaV0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNhbGMgbW91c2UgdHJhdmVyc2UgZGlzdGFuY2Ugb24gYXhpc1xuICAgICAqIEBwYXJhbSBtIC0gbW91c2VcbiAgICAgKi9cbiAgICBwcml2YXRlIF9jYWxjTW91c2VEaXN0YW5jZShtKSB7XG4gICAgICAgIG0uZGlzdEF4WCArPSBNYXRoLmFicyhtLmRpc3RYKTtcbiAgICAgICAgaWYgKG0uZGlyWCAhPT0gMCAmJiBtLmRpclggIT09IG0ubGFzdERpclgpIHtcbiAgICAgICAgICAgIG0uZGlzdEF4WCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBtLmRpc3RBeFkgKz0gTWF0aC5hYnMobS5kaXN0WSk7XG4gICAgICAgIGlmIChtLmRpclkgIT09IDAgJiYgbS5kaXJZICE9PSBtLmxhc3REaXJZKSB7XG4gICAgICAgICAgICBtLmRpc3RBeFkgPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfbW92ZShldmVudCkge1xuICAgICAgICBsZXQgZGVwdGgsIGxpc3Q7XG5cbiAgICAgICAgY29uc3QgZHJhZ1JlY3QgPSB0aGlzLmRyYWdFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLFxuICAgICAgICAgICAgJ2xlZnQnLFxuICAgICAgICAgICAgZXZlbnQucGFnZVggLSB0aGlzLl9tb3VzZS5vZmZzZXRYICsgUFhcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLFxuICAgICAgICAgICAgJ3RvcCcsXG4gICAgICAgICAgICBldmVudC5wYWdlWSAtIHRoaXMuX21vdXNlLm9mZnNldFkgKyBQWFxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuX21vdXNlVXBkYXRlKGV2ZW50KTtcblxuICAgICAgICAvLyBheGlzIG1vdXNlIGlzIG5vdyBtb3Zpbmcgb25cbiAgICAgICAgY29uc3QgbmV3QXggPVxuICAgICAgICAgICAgTWF0aC5hYnModGhpcy5fbW91c2UuZGlzdFgpID4gTWF0aC5hYnModGhpcy5fbW91c2UuZGlzdFkpID8gMSA6IDA7XG5cbiAgICAgICAgLy8gZG8gbm90aGluZyBvbiBmaXJzdCBtb3ZlXG4gICAgICAgIGlmICghdGhpcy5fbW91c2UubW92aW5nKSB7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5kaXJBeCA9IG5ld0F4O1xuICAgICAgICAgICAgdGhpcy5fbW91c2UubW92aW5nID0gMTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNhbGMgZGlzdGFuY2UgbW92ZWQgb24gdGhpcyBheGlzIChhbmQgZGlyZWN0aW9uKVxuICAgICAgICBpZiAodGhpcy5fbW91c2UuZGlyQXggIT09IG5ld0F4KSB7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5kaXN0QXhYID0gMDtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RBeFkgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fY2FsY01vdXNlRGlzdGFuY2UodGhpcy5fbW91c2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX21vdXNlLmRpckF4ID0gbmV3QXg7XG5cbiAgICAgICAgLy8gZmluZCBsaXN0IGl0ZW0gdW5kZXIgY3Vyc29yXG4gICAgICAgIGlmICghaGFzUG9pbnRlckV2ZW50cykge1xuICAgICAgICAgICAgdGhpcy5kcmFnRWwuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcG9pbnRFbCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoXG4gICAgICAgICAgICBldmVudC5wYWdlWCAtIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCxcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VZIC0gKHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wKVxuICAgICAgICApO1xuXG4gICAgICAgIGlmICghaGFzUG9pbnRlckV2ZW50cykge1xuICAgICAgICAgICAgdGhpcy5kcmFnRWwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHBvaW50RWwgJiZcbiAgICAgICAgICAgIChwb2ludEVsLmNsYXNzTGlzdC5jb250YWlucygnbmVzdGFibGUtaXRlbS1tYXNrJykgfHxcbiAgICAgICAgICAgICAgICBwb2ludEVsLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLm9wdGlvbnMucGxhY2VDbGFzcykpXG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5wb2ludEVsID0gcG9pbnRFbC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogbW92ZSBob3Jpem9udGFsXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICAhdGhpcy5vcHRpb25zLmZpeGVkRGVwdGggJiZcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpckF4ICYmXG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5kaXN0QXhYID49IHRoaXMub3B0aW9ucy50aHJlc2hvbGRcbiAgICAgICAgKSB7XG4gICAgICAgICAgICAvLyByZXNldCBtb3ZlIGRpc3RhbmNlIG9uIHgtYXhpcyBmb3IgbmV3IHBoYXNlXG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5kaXN0QXhYID0gMDtcbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzID0gdGhpcy5fcGxhY2Vob2xkZXIucHJldmlvdXNFbGVtZW50U2libGluZztcblxuICAgICAgICAgICAgLy8gaW5jcmVhc2UgaG9yaXpvbnRhbCBsZXZlbCBpZiBwcmV2aW91cyBzaWJsaW5nIGV4aXN0cywgaXMgbm90IGNvbGxhcHNlZCwgYW5kIGNhbiBoYXZlIGNoaWxkcmVuXG4gICAgICAgICAgICBpZiAodGhpcy5fbW91c2UuZGlzdFggPiAwICYmIHByZXZpb3VzKSB7XG4gICAgICAgICAgICAgICAgbGlzdCA9IHByZXZpb3VzLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZSk7XG4gICAgICAgICAgICAgICAgbGlzdCA9IGxpc3RbbGlzdC5sZW5ndGggLSAxXTtcblxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIGRlcHRoIGxpbWl0IGhhcyByZWFjaGVkXG4gICAgICAgICAgICAgICAgZGVwdGggPSBoZWxwZXIuX2dldFBhcmVudHMoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKVxuICAgICAgICAgICAgICAgICkubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRlcHRoICsgdGhpcy5kcmFnRGVwdGggPD0gdGhpcy5vcHRpb25zLm1heERlcHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgc3ViLWxldmVsIGlmIG9uZSBkb2Vzbid0IGV4aXN0XG4gICAgICAgICAgICAgICAgICAgIGlmICghbGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LnN0eWxlLnBhZGRpbmdMZWZ0ID0gdGhpcy5vcHRpb25zLnRocmVzaG9sZCArIFBYO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmRDaGlsZCh0aGlzLl9wbGFjZWhvbGRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91cy5hcHBlbmRDaGlsZChsaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuc2V0UGFyZW50KHByZXZpb3VzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVsc2UgYXBwZW5kIHRvIG5leHQgbGV2ZWwgdXBcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBwcmV2aW91cy5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA6c2NvcGUgPiAkeyB0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lIH1gXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmRDaGlsZCh0aGlzLl9wbGFjZWhvbGRlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBkZWNyZWFzZSBob3Jpem9udGFsIGxldmVsXG4gICAgICAgICAgICBpZiAodGhpcy5fbW91c2UuZGlzdFggPCAwKSB7XG4gICAgICAgICAgICAgICAgLy8gd2UgY2FuJ3QgZGVjcmVhc2UgYSBsZXZlbCBpZiBhbiBpdGVtIHByZWNlZWRzIHRoZSBjdXJyZW50IG9uZVxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICAgICAgICBgLiR7IHRoaXMub3B0aW9ucy5wbGFjZUNsYXNzIH0gKyAkeyB0aGlzLm9wdGlvbnMuaXRlbU5vZGVOYW1lIH1gXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRFbGVtZW50ID0gdGhpcy5fcGxhY2Vob2xkZXIucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICBpZiAoIW5leHQgJiYgcGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbG9zZXN0SXRlbSA9IGhlbHBlci5fY2xvc2VzdChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLml0ZW1Ob2RlTmFtZVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjbG9zZXN0SXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLl9wbGFjZWhvbGRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuX2luc2VydEFmdGVyKHRoaXMuX3BsYWNlaG9sZGVyLCBjbG9zZXN0SXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXBvaW50RWwuY2xhc3NMaXN0LmNvbnRhaW5zKCduZXN0YWJsZS1pdGVtLW1hc2snKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZmluZCByb290IGxpc3Qgb2YgaXRlbSB1bmRlciBjdXJzb3JcbiAgICAgICAgY29uc3QgcG9pbnRFbFJvb3QgPSBoZWxwZXIuX2Nsb3Nlc3QoXG4gICAgICAgICAgICB0aGlzLnBvaW50RWwsXG4gICAgICAgICAgICBgLiR7IHRoaXMub3B0aW9ucy5yb290Q2xhc3MgfWBcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBpc05ld1Jvb3QgPSBwb2ludEVsUm9vdFxuICAgICAgICAgICAgICAgID8gdGhpcy5kcmFnUm9vdEVsLmRhdGFzZXRbJ25lc3RhYmxlLWlkJ10gIT09XG4gICAgICAgICAgICAgICAgcG9pbnRFbFJvb3QuZGF0YXNldFsnbmVzdGFibGUtaWQnXVxuICAgICAgICAgICAgICAgIDogZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIG1vdmUgdmVydGljYWxcbiAgICAgICAgICovXG4gICAgICAgIGlmICghdGhpcy5fbW91c2UuZGlyQXggfHwgaXNOZXdSb290KSB7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiBncm91cHMgbWF0Y2ggaWYgZHJhZ2dpbmcgb3ZlciBuZXcgcm9vdFxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIGlzTmV3Um9vdCAmJlxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5ncm91cCAhPT0gcG9pbnRFbFJvb3QuZGF0YXNldFsnbmVzdGFibGUtZ3JvdXAnXVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjaGVjayBkZXB0aCBsaW1pdFxuICAgICAgICAgICAgZGVwdGggPVxuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ0RlcHRoIC1cbiAgICAgICAgICAgICAgICAxICtcbiAgICAgICAgICAgICAgICBoZWxwZXIuX2dldFBhcmVudHMoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbCxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZSlcbiAgICAgICAgICAgICAgICApLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKGRlcHRoID4gdGhpcy5vcHRpb25zLm1heERlcHRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBiZWZvcmUgPVxuICAgICAgICAgICAgICAgIGV2ZW50LnBhZ2VZIDxcbiAgICAgICAgICAgICAgICBoZWxwZXIuX29mZnNldCh0aGlzLnBvaW50RWwpLnRvcCArIHRoaXMucG9pbnRFbC5jbGllbnRIZWlnaHQgLyAyO1xuICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJQYXJlbnQgPSB0aGlzLl9wbGFjZWhvbGRlci5wYXJlbnROb2RlO1xuXG4gICAgICAgICAgICAvLyBnZXQgcG9pbnQgZWxlbWVudCBkZXB0aFxuICAgICAgICAgICAgbGV0IHBvaW50UmVsYXRpdmVEZXB0aDtcbiAgICAgICAgICAgIHBvaW50UmVsYXRpdmVEZXB0aCA9IGhlbHBlci5fZ2V0UGFyZW50cyhcbiAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWwsXG4gICAgICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZSlcbiAgICAgICAgICAgICkubGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmZpeGVkRGVwdGgpIHtcbiAgICAgICAgICAgICAgICBpZiAocG9pbnRSZWxhdGl2ZURlcHRoID09PSB0aGlzLnJlbGF0aXZlRGVwdGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTGlzdCA9IHRoaXMucG9pbnRFbC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoaWxkTGlzdC5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkTGlzdC5hcHBlbmRDaGlsZCh0aGlzLl9wbGFjZWhvbGRlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBvaW50UmVsYXRpdmVEZXB0aCA9PT0gdGhpcy5yZWxhdGl2ZURlcHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiZWZvcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbC5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWxcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuX2luc2VydEFmdGVyKHRoaXMuX3BsYWNlaG9sZGVyLCB0aGlzLnBvaW50RWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWwucGFyZW50RWxlbWVudC5jaGlsZHJlbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWxcbiAgICAgICAgICAgICAgICAgICAgICAgICkgPT09XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWwucGFyZW50RWxlbWVudC5jaGlsZHJlbi5sZW5ndGggLSAxXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLl9pbnNlcnRBZnRlcih0aGlzLl9wbGFjZWhvbGRlciwgdGhpcy5wb2ludEVsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlcixcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGVscGVyLl9pbnNlcnRBZnRlcih0aGlzLl9wbGFjZWhvbGRlciwgdGhpcy5wb2ludEVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyByZXNldCgpIHtcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuX21vdXNlKTtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuICAgICAgICAgICAgdGhpcy5fbW91c2Vba2V5XSA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9pdGVtSWQgPSAwO1xuICAgICAgICB0aGlzLm1vdmluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRyYWdFbCA9IG51bGw7XG4gICAgICAgIHRoaXMuZHJhZ1Jvb3RFbCA9IG51bGw7XG4gICAgICAgIHRoaXMuZHJhZ0RlcHRoID0gMDtcbiAgICAgICAgdGhpcy5yZWxhdGl2ZURlcHRoID0gMDtcbiAgICAgICAgdGhpcy5oYXNOZXdSb290ID0gZmFsc2U7XG4gICAgICAgIHRoaXMucG9pbnRFbCA9IG51bGw7XG4gICAgfVxuXG4gICAgcHVibGljIGRyYWdTdGFydEZyb21JdGVtKGV2ZW50LCBpdGVtLCBwYXJlbnRMaXN0KSB7XG4gICAgICAgIGlmICghdGhpcy5fcmVnaXN0ZXJIYW5kbGVEaXJlY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuZHJhZ1N0YXJ0KGV2ZW50LCBpdGVtLCBwYXJlbnRMaXN0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZHJhZ1N0YXJ0KGV2ZW50LCBpdGVtLCBwYXJlbnRMaXN0KSB7XG5cbiAgICAgICAgdGhpcy5fb2xkTGlzdExlbmd0aCA9IHRoaXMubGlzdC5sZW5ndGg7XG5cbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZGlzYWJsZURyYWcpIHtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgaWYgKGV2ZW50Lm9yaWdpbmFsRXZlbnQpIHtcbiAgICAgICAgICAgICAgICBldmVudCA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFsbG93IG9ubHkgZmlyc3QgbW91c2UgYnV0dG9uXG4gICAgICAgICAgICBpZiAoZXZlbnQudHlwZS5pbmRleE9mKCdtb3VzZScpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmJ1dHRvbiAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudG91Y2hlcy5sZW5ndGggIT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5yZWYuZGV0YWNoKCk7XG4gICAgICAgICAgICB0aGlzLl9kcmFnSW5kZXggPSBwYXJlbnRMaXN0LmluZGV4T2YoaXRlbSk7XG4gICAgICAgICAgICB0aGlzLmRyYWdNb2RlbCA9IHBhcmVudExpc3Quc3BsaWNlKHBhcmVudExpc3QuaW5kZXhPZihpdGVtKSwgMSlbMF07XG5cbiAgICAgICAgICAgIGNvbnN0IGRyYWdJdGVtID0gaGVscGVyLl9jbG9zZXN0KGV2ZW50LnRhcmdldCwgdGhpcy5vcHRpb25zLml0ZW1Ob2RlTmFtZSk7XG4gICAgICAgICAgICBpZiAoZHJhZ0l0ZW0gPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9wYXJlbnREcmFnSWQgPSBOdW1iZXIucGFyc2VJbnQoXG4gICAgICAgICAgICAgICAgZHJhZ0l0ZW0ucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmlkXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjb25zdCBkcmFnUmVjdCA9IGRyYWdJdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgICAgICB0aGlzLl9zaG93TWFza3MoKTtcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZURyYWdDbG9uZShldmVudCwgZHJhZ0l0ZW0pO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmRyYWdFbCwgJ3dpZHRoJywgZHJhZ1JlY3Qud2lkdGggKyBQWCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZVBsYWNlaG9sZGVyKGV2ZW50LCBkcmFnSXRlbSk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuX3BsYWNlaG9sZGVyLCAnaGVpZ2h0JywgZHJhZ1JlY3QuaGVpZ2h0ICsgUFgpO1xuXG4gICAgICAgICAgICB0aGlzLl9jYWxjdWxhdGVEZXB0aCgpO1xuICAgICAgICAgICAgdGhpcy5kcmFnLmVtaXQoe1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLl9jYW5jZWxNb3VzZXVwID0gdGhpcy5yZW5kZXJlci5saXN0ZW4oXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgJ21vdXNldXAnLFxuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ1N0b3AuYmluZCh0aGlzKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuX2NhbmNlbE1vdXNlbW92ZSA9IHRoaXMucmVuZGVyZXIubGlzdGVuKFxuICAgICAgICAgICAgICAgIGRvY3VtZW50LFxuICAgICAgICAgICAgICAgICdtb3VzZW1vdmUnLFxuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ01vdmUuYmluZCh0aGlzKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBkcmFnU3RvcChldmVudCkge1xuICAgICAgICB0aGlzLl9jYW5jZWxNb3VzZXVwKCk7XG4gICAgICAgIHRoaXMuX2NhbmNlbE1vdXNlbW92ZSgpO1xuICAgICAgICB0aGlzLl9oaWRlTWFza3MoKTtcblxuICAgICAgICBpZiAodGhpcy5kcmFnRWwpIHtcbiAgICAgICAgICAgIGNvbnN0IGRyYWdnZWRJZCA9IE51bWJlci5wYXJzZUludCh0aGlzLmRyYWdFbC5maXJzdEVsZW1lbnRDaGlsZC5pZCk7XG4gICAgICAgICAgICBsZXQgcGxhY2Vob2xkZXJDb250YWluZXIgPSBoZWxwZXIuX2Nsb3Nlc3QoXG4gICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLml0ZW1Ob2RlTmFtZVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgbGV0IGNoYW5nZWRFbGVtZW50UG9zaXRpb24gPVxuICAgICAgICAgICAgICAgIHRoaXMuX2RyYWdJbmRleCAhPT1cbiAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlci5wYXJlbnRFbGVtZW50LmNoaWxkcmVuLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbCh0aGlzLl9wbGFjZWhvbGRlci5wYXJlbnRFbGVtZW50LmNoaWxkcmVuLCB0aGlzLl9wbGFjZWhvbGRlcik7XG5cbiAgICAgICAgICAgIGlmICgodGhpcy5fZHJhZ0luZGV4ID09PSBpbmRleCkgJiYgKHRoaXMuX29sZExpc3RMZW5ndGggPT09IHRoaXMubGlzdC5sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlZEVsZW1lbnRQb3NpdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHBsYWNlaG9sZGVyIGluIHJvb3RcbiAgICAgICAgICAgIGlmIChwbGFjZWhvbGRlckNvbnRhaW5lciA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zcGxpY2UoXG4gICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlci5wYXJlbnRFbGVtZW50LmNoaWxkcmVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAgICAgeyAuLi50aGlzLmRyYWdNb2RlbCB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gcGFsY2Vob2xkZXIgbmVzdGVkXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJDb250YWluZXIgPSBoZWxwZXIuX2ZpbmRPYmplY3RJblRyZWUoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdCxcbiAgICAgICAgICAgICAgICAgICAgTnVtYmVyLnBhcnNlSW50KHBsYWNlaG9sZGVyQ29udGFpbmVyLmlkKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaWYgKCFwbGFjZWhvbGRlckNvbnRhaW5lci5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlckNvbnRhaW5lci5jaGlsZHJlbiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlckNvbnRhaW5lci5jaGlsZHJlbi5wdXNoKHsgLi4udGhpcy5kcmFnTW9kZWwgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJDb250YWluZXIuY2hpbGRyZW4uc3BsaWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlci5wYXJlbnRFbGVtZW50LmNoaWxkcmVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgLi4udGhpcy5kcmFnTW9kZWwgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IHRoaXMuX2RyYWdJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkRWxlbWVudFBvc2l0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghY2hhbmdlZEVsZW1lbnRQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkRWxlbWVudFBvc2l0aW9uID1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyQ29udGFpbmVyWyckJGlkJ10gIT09IHRoaXMuX3BhcmVudERyYWdJZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fcGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgdGhpcy5kcmFnRWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmRyYWdFbCk7XG4gICAgICAgICAgICB0aGlzLmRyYWdFbC5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICAgICAgdGhpcy5saXN0Q2hhbmdlLmVtaXQodGhpcy5saXN0KTtcbiAgICAgICAgICAgIHRoaXMuZHJvcC5lbWl0KHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldmVudCxcbiAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbjogcGxhY2Vob2xkZXJDb250YWluZXIsXG4gICAgICAgICAgICAgICAgaXRlbTogdGhpcy5kcmFnTW9kZWwsXG4gICAgICAgICAgICAgICAgY2hhbmdlZEVsZW1lbnRQb3NpdGlvblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnJlZi5yZWF0dGFjaCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGRyYWdNb3ZlKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmRyYWdFbCkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgaWYgKGV2ZW50Lm9yaWdpbmFsRXZlbnQpIHtcbiAgICAgICAgICAgICAgICBldmVudCA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9tb3ZlKGV2ZW50LnR5cGUuaW5kZXhPZignbW91c2UnKSA9PT0gMCA/IGV2ZW50IDogZXZlbnQudG91Y2hlc1swXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZXhwYW5kQWxsKCkge1xuICAgICAgICBoZWxwZXIuX3RyYXZlcnNlQ2hpbGRyZW4odGhpcy5fbGlzdCwgaXRlbSA9PiB7XG4gICAgICAgICAgICBpdGVtWyckJGV4cGFuZGVkJ10gPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZWYubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNvbGxhcHNlQWxsKCkge1xuICAgICAgICBoZWxwZXIuX3RyYXZlcnNlQ2hpbGRyZW4odGhpcy5fbGlzdCwgaXRlbSA9PiB7XG4gICAgICAgICAgICBpdGVtWyckJGV4cGFuZGVkJ10gPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbn1cbiJdfQ==